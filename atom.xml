<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>muyin568</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-03-28T01:01:25.072Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>muyin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>802.15.4-mac_services</title>
    <link href="http://example.com/wiki/802-15-4-mac-services/"/>
    <id>http://example.com/wiki/802-15-4-mac-services/</id>
    <published>2025-03-27T00:35:47.000Z</published>
    <updated>2025-03-28T01:01:25.072Z</updated>
    
    <content type="html"><![CDATA[<p>介绍了 802.15.4(2015) mac layer services, 包括 genernal review mlme &#x2F; mcps &#x2F; mac constans &amp;&amp; mac pib 。</p><hr style="border: 2px solid #000; margin: 20px 0;"><center><img src="/../images/802-15-4-mac-frm/11_mac_services.png" width="400px"></center><p>MAC 层（媒体访问控制层）负责协调设备之间的无线通信，并分为两个主要部分：<br>1.MAC 层管理实体（<strong>MLME</strong>, MAC Layer Management Entity）<br>2.MAC 公共部分子层（<strong>MCPS</strong>, MAC Common Part Sublayer）</p><hr><p><strong>SAP 的概念</strong><br>在 <strong>IEEE 802.15.4</strong> 标准中，<strong>SAP（服务访问点）</strong> 是<strong>不同协议层之间的接口</strong>，用于<strong>数据传输和管理控制</strong>。<br>SAP 允许协议栈的不同层之间交换数据和命令，例如 <strong>MCPS-SAP</strong> 和 <strong>MLME-SAP</strong>。<br><br/></p><p><strong>SAP 的作用</strong><br>在协议栈中，不同层的功能不同，而 SAP 作为接口，提供标准化的交互方式，例如：</p><ul><li><strong>应用层 ↔️ 网络层</strong> 通过 <strong>NLDE-SAP（网络层数据实体 SAP）</strong> 交换数据。</li><li><strong>网络层 ↔️ MAC 层</strong> 通过 <strong>NLME-SAP（网络层管理实体 SAP）</strong> 进行管理操作。</li><li><strong>MAC 层 ↔️ 物理层</strong> 通过 <strong>PLME-SAP（物理层管理实体 SAP）</strong> 进行通信。</li></ul><br/><p><strong>802.15.4 中常见的 SAP</strong></p><table><thead><tr><th><strong>SAP 名称</strong></th><th><strong>作用</strong></th><th><strong>涉及层</strong></th></tr></thead><tbody><tr><td><strong>MCPS-SAP</strong>（MAC Common Part Sublayer Service Access Point）</td><td>处理 MAC 层<strong>数据传输</strong></td><td>MAC 层 ↔️ 上层</td></tr><tr><td><strong>MLME-SAP</strong>（MAC Layer Management Entity Service Access Point）</td><td>处理 MAC 层<strong>管理功能</strong>（如信标、关联）</td><td>MAC 层 ↔️ 上层</td></tr><tr><td><strong>PLME-SAP</strong>（Physical Layer Management Entity Service Access Point）</td><td>物理层<strong>管理</strong>（如信道设置）</td><td>物理层 ↔️ MAC 层</td></tr><tr><td><strong>PD-SAP</strong>（Physical Data Service Access Point）</td><td>物理层<strong>数据传输</strong></td><td>物理层 ↔️ MAC 层</td></tr></tbody></table><br/><p><strong>SAP 的工作方式</strong><br>SAP 主要通过以下方式进行交互： ind + resp ; req + confirm</p><ul><li><p><strong>Indication（指示）</strong>：下层通知上层某个事件发生（如收到数据）。</p></li><li><p><strong>Response（响应）</strong>：上层对某个请求的回应（如关联请求的确认）。</p></li><li><p><strong>Request（请求）</strong>：上层请求下层执行某项操作（如发送数据）。</p></li><li><p><strong>Confirm（确认）</strong>：下层反馈请求的执行结果（如数据发送成功或失败）。</p></li></ul><br/><p><strong>SAP 示例（MCPS-DATA 发送流程）</strong><br>假设一个设备要发送数据，SAP 交互流程如下：</p><ol><li><strong>上层调用</strong> <code>MCPS-DATA.request</code>，请求 MAC 层发送数据。  </li><li><strong>MAC 层处理</strong> 该请求，并通过物理层发送数据。  </li><li><strong>如果对方收到数据并回复 ACK</strong>，MAC 层生成 <code>MCPS-DATA.confirm</code> 反馈给上层，表示发送成功。  </li><li><strong>如果对方未响应</strong>，MAC 层可能会重传，最终给出 <code>MCPS-DATA.confirm</code>，通知上层发送成功或失败。</li></ol><hr style="border: 2px solid #000; margin: 20px 0;"><h4 id="MLME-primtives"><a href="#MLME-primtives" class="headerlink" title="MLME primtives"></a>MLME primtives</h4><p>MLME-SAP（MAC 层管理实体服务访问点）接口用于上层与 MAC 层之间的管理交互。它提供了一系列的 <strong>原语（primitives）</strong>，用于执行网络管理、配置以及控制操作。包括设备的加入&#x2F;退出网络、扫描、同步、参数设置、信标通知等。这些原语是 <strong>MAC MLME</strong> 的核心部分，帮助设备与网络协调工作，确保 PAN 的正常运行。</p><hr><br/><h5 id="common-情况处理-MLME-处理-higher-layer-内容时出现问题"><a href="#common-情况处理-MLME-处理-higher-layer-内容时出现问题" class="headerlink" title="common 情况处理(MLME 处理 higher layer 内容时出现问题)"></a>common 情况处理(MLME 处理 higher layer 内容时出现问题)</h5><p><strong>错误处理（Request（请求））</strong></p><ul><li>如果在 <strong>请求原语</strong> 的 <strong>发送帧安全处理</strong>（如 9.2.1 所述）中发生任何错误，<strong>MLME</strong> 会丢弃该帧，并使用相应的确认原语，返回 <strong>发送帧安全处理</strong> 中的错误。</li></ul><p><strong>错误处理（Response（响应））</strong></p><ul><li>如果在 <strong>响应原语</strong> 的 <strong>发送帧安全处理</strong>（如 9.2.1 所述）中发生任何错误，<strong>MLME</strong> 会丢弃该帧，并使用 <strong>MLME-COMM-STATUS.indication</strong> 原语，返回 <strong>发送帧安全处理</strong> 中的错误。</li></ul><p><strong>参数无效或超出范围</strong></p><ul><li><p>如果 <strong>请求原语</strong> 中的任何参数不受支持或超出范围，<strong>MAC 子层</strong> 会使用 <strong>INVALID_PARAMETER</strong> 状态值返回相应的确认原语。</p></li><li><p>如果 <strong>响应原语</strong> 中的任何参数不受支持或超出范围，<strong>MAC 子层</strong> 会使用 <strong>INVALID_PARAMETER</strong> 状态值返回 <strong>MLME-COMM-STATUS.indication</strong> 原语。</p></li></ul><p><strong>CSMA-CA 失败</strong></p><ul><li>如果由于 <strong>CSMA-CA 算法失败</strong>，<strong>MLME</strong> 无法发送 <strong>请求原语</strong> 所需的帧，<strong>MLME</strong> 会使用 <strong>CHANNEL_ACCESS_FAILURE</strong> 状态值返回相应的确认原语。</li></ul><p><strong>ACK 未收到</strong></p><ul><li>如果 <strong>MLME</strong> 成功发送 <strong>请求原语</strong> 所需的帧，但没有收到预期的确认帧，<strong>MLME</strong> 会使用 <strong>NO_ACK</strong> 状态值返回相应的确认原语。</li></ul><hr><br/><p><strong>关键MLME原语</strong></p><ol><li><strong>MLME-ASSOCIATE</strong>: 设备请求加入网络时使用此原语。包含关联请求、确认、指示和响应。设备通过该原语与 PAN 协调器建立连接。</li><li><strong>MLME-SCAN</strong>: 该原语用于启动扫描操作，寻找可用的 PAN 网络。可以进行主动扫描（发送探测请求）或被动扫描（接收信标）。</li><li><strong>MLME-SYNC</strong>: 该原语用于设备与协调器之间的同步，确保设备与网络的时序同步。</li><li><strong>MLME-START</strong>: 该原语用于协调器启动或重新启动一个 PAN，分配新的 PAN ID，并开始信标传输。</li><li><strong>MLME-BEACON-NOTIFY</strong>: 设备接收到 PAN 协调器的信标时使用此原语，通知设备信标信息，如网络同步信息和协作参数。</li><li><strong>MLME-PROMISCUOUSMODE</strong>: 该原语允许设备进入混杂模式，即设备可以接收所有频段上的数据包，而不仅仅是属于其自己 PAN 的数据包。</li><li><strong>MLME-SET 和 MLME-GET</strong>: 这两个原语用于配置和查询 MAC 层的参数，例如 PAN ID、信标周期、重试次数等。</li></ol><hr><br/><h4 id="举例MLME-ASSOCIATE-request"><a href="#举例MLME-ASSOCIATE-request" class="headerlink" title="举例MLME-ASSOCIATE.request"></a>举例MLME-ASSOCIATE.request</h4><p><code> mlme primitive 类似于 bluetooth 的 hci cmd / hci evt，去进行一些 mac layer 控制管理</code> ，在802.15.4 中都有详细的参数描述解释定义。下面举例MLME-ASSOCIATE.request：</p><p><strong>MLME-ASSOCIATE.request 原语详细解析</strong><br>在 <strong>IEEE 802.15.4</strong> 标准中，<code>MLME-ASSOCIATE.request</code> 是一个用于设备请求加入 <strong>PAN 网络</strong> 的原语。设备通过该原语向 MAC 层请求与 <strong>PAN 协调器</strong> 建立关联。</p><p><strong>MLME-ASSOCIATE.request 的参数</strong></p><p><code>MLME-ASSOCIATE.request</code> 原语包含以下主要参数：</p><table><thead><tr><th><strong>参数名称</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>deviceAddress</strong></td><td>设备的地址，通常是设备的 MAC 地址。可以是 <strong>短地址</strong>（16位）或 <strong>扩展地址</strong>（64位）。</td></tr><tr><td><strong>capabilityInformation</strong></td><td>设备的能力信息，用来表示设备是否支持某些功能（例如，是否支持 FFD（Full Function Device）或 RFD（Reduced Function Device）等）。</td></tr><tr><td><strong>securityLevel</strong></td><td>表示安全级别，指明通信过程中使用的加密方式及密钥管理。</td></tr><tr><td><strong>pansId</strong></td><td>指定目标 PAN 的 PAN ID。设备需要指定与之关联的 PAN。</td></tr><tr><td><strong>assocDeviceAddress</strong></td><td>设备的目标关联设备的地址。设备会尝试与此地址对应的 PAN 协调器建立联系。</td></tr></tbody></table><hr><br/><p><strong>MLME-ASSOCIATE.request 的执行流程</strong></p><p>当 <strong>MLME-ASSOCIATE.request</strong> 被发出时，MAC 层会按照以下步骤执行：</p><ol><li><p><strong>参数验证</strong><br>MAC 层首先验证原语中的 <strong>参数</strong>，例如设备地址、能力信息等是否合理。如果参数无效，原语将失败。</p></li><li><p><strong>访问权限检查</strong><br>MAC 层会根据设备的类型（如 <strong>FFD</strong> 或 <strong>RFD</strong>）和能力信息，决定是否允许设备与目标 PAN 协调器建立连接。<strong>FFD</strong> 可以充当 PAN 协调器，而 <strong>RFD</strong> 只能与 <strong>FFD</strong> 设备建立连接。</p></li><li><p><strong>发送关联请求</strong><br>如果验证通过，MAC 层将构造一个 <strong>关联请求帧</strong>（Association Request Frame）。该帧包含设备的地址、能力信息等数据，然后发送到目标 <strong>PAN 协调器</strong>。</p></li><li><p><strong>等待响应</strong><br>协调器收到请求后，会通过 <strong>MLME-ASSOCIATE.response</strong> 原语向设备响应，表明关联是否成功。如果成功，设备将被分配一个 <strong>PAN 地址</strong>（如果是新的设备）。</p></li><li><p><strong>关联成功或失败</strong>  </p><ul><li>如果关联成功，MAC 层会使用 <strong>MLME-ASSOCIATE.confirm</strong> 向上层发送确认，表示设备已经成功加入网络。</li><li>如果失败，MAC 层会发送失败指示（例如，因 PAN ID 不匹配或设备能力不符合要求）。</li></ul></li></ol><hr><br/><p><strong>与 PIB（Protocol Information Base）的关系</strong></p><p>在 <strong>MLME-ASSOCIATE.request</strong> 执行时，<strong>PIB</strong>（协议信息库）中的相关参数起着重要作用。PIB 包含与设备配置和网络管理相关的所有信息，以下是几个可能影响关联过程的 PIB 项目：</p><ol><li><p><strong>macPANId</strong><br>设备将会通过 <code>MLME-ASSOCIATE.request</code> 中的 <strong>pansId</strong> 参数向目标协调器发起关联请求，PIB 中的 <code>macPANId</code> 必须与请求的 PAN ID 匹配。</p></li><li><p><strong>macShortAddress</strong> 和 <strong>macExtendedAddress</strong><br>设备的地址会通过 <strong>deviceAddress</strong> 参数传递。MAC 层会根据 PIB 中存储的设备地址信息来处理设备的身份验证与连接。</p></li><li><p><strong>macAssociationPermit</strong><br>如果 PIB 中的 <code>macAssociationPermit</code> 为 <code>FALSE</code>，即禁用关联，MAC 层会拒绝设备的关联请求。</p></li><li><p><strong>macBeaconOrder</strong><br>如果设备在扫描过程中检测到的信标符合其 <strong>macBeaconOrder</strong>（信标周期）配置，MAC 层才会继续发送关联请求。</p></li><li><p><strong>macDeviceType</strong><br>设备的类型（FFD 或 RFD）通过 <strong>capabilityInformation</strong> 参数传递。PIB 中的 <code>macDeviceType</code> 会影响设备是否能成功加入网络。</p></li></ol><hr style="border: 2px solid #000; margin: 20px 0;"><h4 id="MCPS-primtives"><a href="#MCPS-primtives" class="headerlink" title="MCPS primtives"></a>MCPS primtives</h4><p>MAC 数据服务（MAC Data Service）通过 MCPS（MAC 层数据服务）接口提供了数据传输的基本功能</p><p><strong>功能</strong></p><ul><li><strong>发送数据</strong>：用于将数据从发送方传输到接收方。数据传输可以通过 <strong>点对点通信</strong> 或 <strong>广播</strong> 进行。</li><li><strong>接收数据</strong>：MAC 层也能够处理从物理层接收到的数据包，将其传递给上层。</li><li><strong>保证数据的可靠性</strong>：MAC 层通过重新传输机制、确认机制来保证数据的传输可靠性。</li></ul><p><strong>传输类型</strong></p><ul><li><strong>数据帧</strong>：通过数据服务传输的基本单元是数据帧（Data Frame），包括数据的有效载荷、目的地址、源地址等信息。</li><li><strong>确认（ACK）帧</strong>：用于确认数据帧的接收。</li></ul><hr><br/><p><strong>MCPS 原语</strong></p><ul><li><strong>MCPS-DATA.request</strong>：请求发送数据帧。</li><li><strong>MCPS-DATA.confirm</strong>：确认数据发送的结果。</li><li><strong>MCPS-DATA.indication</strong>：通知上层接收到的数据帧。</li></ul><p><strong>Purging 操作</strong></p><ul><li><strong>MCPS-PURGE.request</strong>：请求清除数据队列中的未成功发送的数据帧。</li><li><strong>MCPS-PURGE.confirm</strong>：确认是否成功清除数据队列中的数据帧。</li></ul><hr><br/><h4 id="举例MCPS-DATA-request"><a href="#举例MCPS-DATA-request" class="headerlink" title="举例MCPS-DATA.request"></a>举例MCPS-DATA.request</h4><p>在 <strong>IEEE 802.15.4</strong> 中，<code>MCPS-DATA.request</code> 是用于请求发送数据帧的原语。<br><br/></p><p><strong>1. MCPS-DATA.request 参数解析</strong></p><p><code>MCPS-DATA.request</code> 原语的参数通常包括以下内容：</p><table><thead><tr><th><strong>参数名称</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>dstAddr</strong></td><td>目标设备地址，通常为 <strong>短地址</strong> 或 <strong>扩展地址</strong>。可以是单播地址或广播地址。</td></tr><tr><td><strong>srcAddr</strong></td><td>源设备地址，通常为发送设备的 <strong>短地址</strong> 或 <strong>扩展地址</strong>。</td></tr><tr><td><strong>frame</strong></td><td>要发送的数据帧，其中包括数据的有效载荷、目的地址、源地址等信息。</td></tr><tr><td><strong>securityLevel</strong></td><td>数据传输的安全级别，指示是否进行加密、验证等。此字段可以影响数据发送的安全性。</td></tr><tr><td><strong>ackRequired</strong></td><td>是否要求接收方返回确认帧（ACK）。如果为 <code>true</code>，MAC 层将等待接收方的 ACK 响应。</td></tr><tr><td><strong>txOptions</strong></td><td>传输选项，可以指定数据帧发送的额外特性（例如是否为广播帧等）。</td></tr></tbody></table><br/><p><strong>2. MCPS-DATA.request 执行流程</strong><br><br/></p><p><strong>2.1 数据准备</strong></p><ul><li>当上层应用或协议栈调用 <code>MCPS-DATA.request</code> 请求发送数据时，MAC 层会进行以下准备工作：<ol><li><strong>验证请求参数</strong>：检查目标地址、源地址等字段是否有效。</li><li><strong>构建数据帧</strong>：根据请求中的 <code>frame</code> 和其他参数构建数据帧。该数据帧包括了源地址、目标地址、有效载荷、序列号等信息。</li><li><strong>检查安全性设置</strong>：根据 <code>securityLevel</code> 参数，MAC 层会决定是否进行数据加密或认证。</li></ol></li></ul><br/><p><strong>2.2 与 PIB（协议信息库）的关系</strong><br>MAC 层会查询 <strong>PIB（Protocol Information Base）</strong> 来获取与数据发送相关的配置信息。PIB 中的一些关键参数影响数据的发送过程：<br><br/></p><ol><li><strong>macPANId</strong>：用于判断数据是否属于目标 PAN。如果数据的 <code>dstAddr</code> 与 <code>macPANId</code> 不匹配，发送操作将失败。</li><li><strong>macShortAddress</strong> 和 <strong>macExtendedAddress</strong>：这些字段用于构建源地址和目标地址，特别是设备的 16 位或 64 位地址。</li><li><strong>macAckWaitDuration</strong>：控制数据帧等待 ACK 响应的时间。如果 <code>ackRequired</code> 为 <code>true</code>，MAC 层会使用该配置项来设置等待 ACK 的最大时长。</li><li><strong>macMaxFrameRetries</strong>：如果数据发送失败，MAC 层会尝试重新发送。此参数指定最大重试次数。</li><li><strong>macMaxFrameSize</strong>：控制单个数据帧的最大大小。如果数据帧超过最大帧大小，MAC 层可能会将数据进行分段。</li></ol><br/><p><strong>2.3 数据帧的发送</strong></p><ul><li><strong>物理层发送</strong>：MAC 层会将构建好的数据帧交给物理层进行发送。物理层负责将数据转换为无线信号并传输。<br/></li></ul><p><strong>2.4 确认机制</strong></p><ul><li>如果 <code>ackRequired</code> 为 <code>true</code>，MAC 层会等待接收方发送 ACK 帧作为确认。如果在指定时间内没有收到 ACK，MAC 层会根据 <strong>PIB</strong> 中的 <code>macMaxFrameRetries</code> 设置重试次数，直到成功或超出最大重试次数。<br/></li></ul><p><strong>2.5 发送确认</strong></p><ul><li>如果数据成功发送，MAC 层会通过 <strong>MCPS-DATA.confirm</strong> 向上层应用发送数据发送成功的确认。</li><li>如果发送失败（例如超时或重试次数用尽），MAC 层会通知上层失败原因。</li></ul><hr style="border: 2px solid #000; margin: 20px 0;"><h4 id="MAC-constants-PIB"><a href="#MAC-constants-PIB" class="headerlink" title="MAC constants &amp;&amp; PIB"></a>MAC constants &amp;&amp; PIB</h4><p>在 <strong>IEEE 802.15.4</strong> 标准中，MAC（Medium Access Control）层使用一些常量和 PIB（Protocol Information Base）属性来控制和配置设备的行为。常量用于设置 MAC 层操作的参数范围，而 PIB 属性则保存设备的配置和状态信息。以下是 <strong>MAC 常量</strong> 和 <strong>PIB 属性</strong> 的详细说明。</p><hr><br/><p><strong>1. MAC 常量</strong></p><p><strong>1.1 常量概述</strong><br>MAC 常量是预定义的常量值，用于指定在 MAC 层操作中使用的各种参数。例如，这些常量用于数据传输、重试次数、最大帧大小等。它们定义了 MAC 层的一些行为规范。</p><p><strong>1.2 常见的 MAC 常量</strong></p><table><thead><tr><th><strong>常量名称</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>MAC_MAX_FRAME_RETRIES</strong></td><td>最大帧重试次数。指定在发送数据时，MAC 层允许的最大重试次数。默认值为 <strong>3</strong>。</td></tr><tr><td><strong>MAC_ACK_WAIT_DURATION</strong></td><td>等待确认的时间（单位：符号时间），指定了设备在发送数据后，最多等待多少符号时间以接收 ACK。</td></tr><tr><td><strong>MAC_MAX_FRAME_SIZE</strong></td><td>最大数据帧大小。指定了数据帧的最大长度（以字节为单位）。</td></tr><tr><td><strong>MAC_PAN_ID</strong></td><td>PAN（Personal Area Network）ID，指定设备所属的 PAN 标识符。</td></tr><tr><td><strong>MAC_BROADCAST_ADDR</strong></td><td>广播地址。通常用于广播数据包。</td></tr><tr><td><strong>MAC_SECURITY_ENABLED</strong></td><td>安全功能启用标志。如果为 <code>true</code>，表示启用安全功能（如加密和认证）。</td></tr><tr><td><strong>MAC_FRAME_TYPE_DATA</strong></td><td>数据帧类型常量。指定该数据帧是数据传输帧。</td></tr><tr><td><strong>MAC_FRAME_TYPE_ACK</strong></td><td>确认帧类型常量。指定该数据帧是 ACK 确认帧。</td></tr></tbody></table><p><strong>1.3 常量用途</strong><br>这些常量定义了设备的行为规范，例如：</p><ul><li><strong>MAC_MAX_FRAME_RETRIES</strong> 控制最大重试次数，确保设备不会因为多次发送失败而进入无限重试状态。</li><li><strong>MAC_ACK_WAIT_DURATION</strong> 确定了设备在发送数据后等待确认的时间，这对于网络中的数据传输延迟控制至关重要。</li><li><strong>MAC_SECURITY_ENABLED</strong> 则控制设备是否使用加密和认证机制，提高数据传输的安全性。</li></ul><hr><br/><p><strong>2. PIB 属性</strong></p><p><strong>2.1 PIB 概述</strong><br>PIB（Protocol Information Base）是一个存储协议配置信息的数据库。它保存了与 MAC 层的操作相关的各种配置和状态信息。PIB 属性用于配置设备的 MAC 层行为，并在设备运行时进行修改和读取。</p><p><strong>2.2 常见的 PIB 属性</strong></p><table><thead><tr><th><strong>属性名称</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>macShortAddress</strong></td><td>设备的短地址（16 位）。用于标识设备在同一 PAN 内的唯一性。</td></tr><tr><td><strong>macExtendedAddress</strong></td><td>设备的扩展地址（64 位），在 PAN 内唯一标识设备。</td></tr><tr><td><strong>macPANId</strong></td><td>PAN 的标识符，设备所属的个人区域网络的 ID。</td></tr><tr><td><strong>macBeaconOrder</strong></td><td>信标周期的周期性参数，指示设备发射信标的频率。</td></tr><tr><td><strong>macSuperframeOrder</strong></td><td>超帧顺序，决定设备在网络中活动时使用的时间段。</td></tr><tr><td><strong>macMaxFrameRetries</strong></td><td>数据传输失败后的最大重试次数。</td></tr><tr><td><strong>macMaxCSMABackoffs</strong></td><td>在发送数据之前，设备允许的最大退避次数，用于避免碰撞。</td></tr><tr><td><strong>macSecurityMode</strong></td><td>安全模式，指示是否启用加密和认证。</td></tr><tr><td><strong>macRxOnWhenIdle</strong></td><td>设备是否在空闲时保持接收模式。如果为 <code>true</code>，设备即使在空闲时也能接收数据。</td></tr><tr><td><strong>macMaxFrameSize</strong></td><td>允许的最大数据帧大小。</td></tr><tr><td><strong>macAckWaitDuration</strong></td><td>等待确认的最大时间（符号时间单位）。</td></tr><tr><td><strong>macTransactionPersistenceTime</strong></td><td>事务持久化时间，指示在事务期间内设备可以保持数据传输状态。</td></tr></tbody></table><p><strong>2.3 PIB 属性用途</strong><br>PIB 属性用于控制和配置设备在 <strong>MAC 层</strong> 上的行为。下面是一些常见的 PIB 属性及其应用：</p><ul><li><strong>macShortAddress 和 macExtendedAddress</strong>：用于设备地址的标识。短地址通常用于快速数据传输，而扩展地址用于全局唯一的标识。</li><li><strong>macPANId</strong>：用于标识设备所属的网络。PAN ID 是设备加入网络的关键参数，确保设备可以识别网络并与其他设备进行通信。</li><li><strong>macMaxFrameRetries</strong>：控制重试次数，确保数据的可靠传输。</li><li><strong>macSecurityMode</strong>：确定是否启用安全特性（如加密和认证），保证数据的安全性。</li><li><strong>macMaxCSMABackoffs</strong>：控制发送失败后的退避次数，用于减少碰撞并提高传输效率。</li></ul><br/><p><em><strong>2.4 PIB 和 MAC 常量的关系</strong></em><br><em>许多 <strong>PIB 属性</strong> 实际上是由 <strong>MAC 常量</strong> 决定的。例如，<code>macMaxFrameRetries</code> 和 <code>MAC_MAX_FRAME_RETRIES</code> 常量是相互关联的。常量用于设置默认值，而 PIB 属性用于在运行时修改和读取设备的配置。</em></p><hr><br/><p><strong>3. PIB 属性的访问与修改</strong></p><p><strong>3.1 读取和设置 PIB 属性</strong><br>设备可以通过特定的接口来读取和修改 PIB 属性。例如，设备可以通过 <strong>MLME</strong>（MAC Layer Management Entity）接口来设置或获取 PIB 属性。</p><p><strong>示例：设置 PIB 属性</strong></p><pre><code class="language-c">MLME_SET.request &#123;  pibAttribute: macShortAddress,  pibAttributeValue: 0x1234&#125;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;介绍了 802.15.4(2015) mac layer services, 包括 genernal review mlme &amp;#x2F; mcps &amp;#x2F; mac constans &amp;amp;&amp;amp; mac pib 。&lt;/p&gt;
&lt;hr style=&quot;border</summary>
      
    
    
    
    <category term="802.15.4" scheme="http://example.com/categories/802-15-4/"/>
    
    
    <category term="802.15.4" scheme="http://example.com/tags/802-15-4/"/>
    
  </entry>
  
  <entry>
    <title>hexo github.io image 显示异常</title>
    <link href="http://example.com/wiki/hexo-image-sync-my-solution/"/>
    <id>http://example.com/wiki/hexo-image-sync-my-solution/</id>
    <published>2025-03-25T23:53:42.000Z</published>
    <updated>2025-03-26T00:20:56.533Z</updated>
    
    <content type="html"><![CDATA[<p>在使用 hexo 写 blog 插入图片时，大多数会使用 typora&#x2F;markdown allin one 等去 preview，此时的(preview) img path 是相对 source&#x2F;_posts&#x2F;**.md 文档的路径；而 github.io 静态页面展示图片是要使用public 为 root path 的路径引用图片；路径不match 会导致图片显示异常，网上也有很多的案例和解法，使用起来感觉始终不顺手，在这里放上我的解法。</p><hr><br>1.创建如下目录结构：blog/source/images , blog/public/images , blog/sync.py<br>2.编辑 **.md 并想要预览时，请插入类似下面的图片链接<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;center&gt;&lt;img src=&quot;/../images/802-15-4-mac-frm/4_beacon_frm.png&quot; width=&quot;800px&quot;&gt;&lt;/center&gt;</span><br></pre></td></tr></table></figure><br>3.完成编辑后在 blog folder 下运行 python3 sync.py add sync, 会将 source/images 下 img sync 到 public/imgs, 同时将所有 **.md 中的图片链接前加“/”转为如下，使可以在github.io上显示<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;center&gt;&lt;img src=&quot;/../images/802-15-4-mac-frm/4_beacon_frm.png&quot; width=&quot;800px&quot;&gt;&lt;/center&gt;</span><br></pre></td></tr></table></figure><br>4.运行 python3 sync.py add sync 后 md preview 将无法正常显示图片，如果想重新编辑可以再运行 python3 sync.py remove 即可<br>5.我的上blog step:  python3 sync.py add sync -> hexo c -> hexo g -> hexo d<hr style="border: 2px solid #000; margin: 20px 0;">**下面附上sync.py的code，这个是请教chatgpt帮忙写的**<table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>python sync_and_modify.py sync</code></td><td>仅同步 <code>source/images</code> 到 <code>public/images</code></td></tr><tr><td><code>python sync_and_modify.py add</code></td><td>仅增加 Markdown 中 <code>img src</code> 里的 <code>/</code></td></tr><tr><td><code>python sync_and_modify.py sync add</code></td><td><strong>同步图片 + 增加 <code>/</code></strong></td></tr><tr><td><code>python sync_and_modify.py remove</code></td><td>仅去掉 Markdown 中 <code>img src</code> 里的 <code>/</code>（<strong>单独执行</strong>）</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sync_folders</span>(<span class="params">src, dest</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    同步 source/images 到 public/images，确保文件和目录保持一致。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(src):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;源目录 <span class="subst">&#123;src&#125;</span> 不存在！&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(dest):</span><br><span class="line">        os.makedirs(dest)  <span class="comment"># 如果目标文件夹不存在，则创建</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(src):</span><br><span class="line">        rel_path = os.path.relpath(root, src)</span><br><span class="line">        target_dir = os.path.join(dest, rel_path)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(target_dir):</span><br><span class="line">            os.makedirs(target_dir)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            src_file = os.path.join(root, file)</span><br><span class="line">            dest_file = os.path.join(target_dir, file)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(dest_file) <span class="keyword">or</span> os.path.getmtime(src_file) &gt; os.path.getmtime(dest_file):</span><br><span class="line">                shutil.copy2(src_file, dest_file)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;同步文件: <span class="subst">&#123;src_file&#125;</span> -&gt; <span class="subst">&#123;dest_file&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;图片同步完成！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modify_image_paths_in_markdown</span>(<span class="params">posts_folder, mode</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    遍历 source/_posts 目录下所有 .md 文件，修改 img 标签中的 src 路径。</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">        posts_folder: Markdown 文件所在目录（如 source/_posts）</span></span><br><span class="line"><span class="string">        mode: &quot;remove_slash&quot; -&gt; 移除 img src 里开头的 &quot;/&quot;</span></span><br><span class="line"><span class="string">              &quot;add_slash&quot; -&gt; 给 img src 里开头增加 &quot;/&quot;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(posts_folder):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Markdown 目录 <span class="subst">&#123;posts_folder&#125;</span> 不存在！&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 正则匹配 `&lt;img src=&quot;...&quot;` 语法</span></span><br><span class="line">    pattern_remove_slash = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(&lt;img src=&quot;)/(\.\./images/[^&quot;]+&quot;)&#x27;</span>)</span><br><span class="line">    pattern_add_slash = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(&lt;img src=&quot;)(\.\./images/[^&quot;]+&quot;)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    modified_files = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(posts_folder):</span><br><span class="line">        <span class="keyword">if</span> filename.endswith(<span class="string">&quot;.md&quot;</span>):</span><br><span class="line">            file_path = os.path.join(posts_folder, filename)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                content = f.read()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 根据模式修改</span></span><br><span class="line">            <span class="keyword">if</span> mode == <span class="string">&quot;remove_slash&quot;</span>:</span><br><span class="line">                new_content = pattern_remove_slash.sub(<span class="string">r&#x27;\1\2&#x27;</span>, content)</span><br><span class="line">            <span class="keyword">elif</span> mode == <span class="string">&quot;add_slash&quot;</span>:</span><br><span class="line">                new_content = pattern_add_slash.sub(<span class="string">r&#x27;\1/\2&#x27;</span>, content)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;未知模式：<span class="subst">&#123;mode&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果内容发生变化，则写入文件</span></span><br><span class="line">            <span class="keyword">if</span> content != new_content:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(new_content)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;已修改文件: <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">                modified_files += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Markdown 文件路径修改完成，共修改 <span class="subst">&#123;modified_files&#125;</span> 个文件！&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 设置文件夹路径</span></span><br><span class="line">    source_images = <span class="string">&quot;source/images&quot;</span></span><br><span class="line">    public_images = <span class="string">&quot;public/images&quot;</span></span><br><span class="line">    markdown_folder = <span class="string">&quot;source/_posts&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析命令行参数</span></span><br><span class="line">    args = <span class="built_in">set</span>(arg.lower() <span class="keyword">for</span> arg <span class="keyword">in</span> sys.argv[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> args:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用法: python sync_and_modify.py [sync] [add] | remove&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;remove&quot;</span> <span class="keyword">in</span> args <span class="keyword">and</span> <span class="built_in">len</span>(args) &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;错误：remove 只能单独执行，不能与 sync 或 add 组合！&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;sync&quot;</span> <span class="keyword">in</span> args:</span><br><span class="line">        sync_folders(source_images, public_images)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;add&quot;</span> <span class="keyword">in</span> args:</span><br><span class="line">        modify_image_paths_in_markdown(markdown_folder, mode=<span class="string">&quot;add_slash&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;remove&quot;</span> <span class="keyword">in</span> args:</span><br><span class="line">        modify_image_paths_in_markdown(markdown_folder, mode=<span class="string">&quot;remove_slash&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><br>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在使用 hexo 写 blog 插入图片时，大多数会使用 typora&amp;#x2F;markdown allin one 等去 preview，此时的(preview) img path 是相对 source&amp;#x2F;_posts&amp;#x2F;**.md 文档的路径；而 gi</summary>
      
    
    
    
    <category term="技术杂谈" scheme="http://example.com/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/"/>
    
    
    <category term="hexo" scheme="http://example.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>802.15.4-mac_frm-general_review</title>
    <link href="http://example.com/wiki/802-15-4-mac-frm/"/>
    <id>http://example.com/wiki/802-15-4-mac-frm/</id>
    <published>2025-03-10T11:23:52.000Z</published>
    <updated>2025-03-27T01:03:24.033Z</updated>
    
    <content type="html"><![CDATA[<p>主要介绍了 802.15.4 mac layer pdu 形式与各 bit 含义, 及各 field 内容</p><hr style="border: 2px solid #000; margin: 20px 0;"><h2 id="General-MAC-frame-format"><a href="#General-MAC-frame-format" class="headerlink" title="General MAC frame format"></a>General MAC frame format</h2><center><img src="/../images/802-15-4-mac-frm/1_general_format.png" width="800px"></center><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="frm-control"><a href="#frm-control" class="headerlink" title="frm control"></a>frm control</h3><table><thead><tr><th>Bits</th><th>0–2</th><th>3</th><th>4–5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10–11</th><th>12–13</th><th>14–15</th></tr></thead><tbody><tr><td>Field</td><td>Frame Type</td><td>Security Enabled</td><td>Frame Pending</td><td>AR</td><td>PAN ID Compression</td><td>Reserved</td><td>Sequence Number Suppression</td><td>IE Present</td><td>Destination Addressing Mode</td><td>Frame Version</td></tr></tbody></table><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="mac-frm-type"><a href="#mac-frm-type" class="headerlink" title="mac frm type"></a>mac frm type</h3><table><thead><tr><th>b2</th><th>b1</th><th>b0</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>Beacon</td></tr><tr><td>0</td><td>0</td><td>1</td><td>Data</td></tr><tr><td>0</td><td>1</td><td>0</td><td>Acknowledgment</td></tr><tr><td>0</td><td>1</td><td>1</td><td>MAC command</td></tr><tr><td>1</td><td>0</td><td>0</td><td>Reserved</td></tr><tr><td>1</td><td>0</td><td>1</td><td>Multipurpose</td></tr><tr><td>1</td><td>1</td><td>0</td><td>Fragment or Fraka</td></tr><tr><td>1</td><td>1</td><td>1</td><td>Extended</td></tr></tbody></table><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="Security-Enabled-字段解析"><a href="#Security-Enabled-字段解析" class="headerlink" title="Security Enabled 字段解析"></a>Security Enabled 字段解析</h3><h4 id="字段功能"><a href="#字段功能" class="headerlink" title="字段功能"></a>字段功能</h4><p><code>Security Enabled</code> 字段用于指示 MAC 子层是否对该帧进行了安全保护。</p><table><thead><tr><th>Security Enabled 值</th><th>作用</th></tr></thead><tbody><tr><td>1</td><td>启用 MAC 层安全保护，帧头包含<strong>Auxiliary Security Header</strong></td></tr><tr><td>0</td><td>未启用安全保护，帧头不包含<strong>Auxiliary Security Header</strong></td></tr></tbody></table><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="Frame-Pending-字段解析"><a href="#Frame-Pending-字段解析" class="headerlink" title="Frame Pending 字段解析"></a>Frame Pending 字段解析</h3><h4 id="字段功能-1"><a href="#字段功能-1" class="headerlink" title="字段功能"></a>字段功能</h4><p><code>Frame Pending</code> 字段用于指示发送设备是否有更多数据等待发送给接收设备。  </p><table><thead><tr><th>Frame Pending 值</th><th>作用</th></tr></thead><tbody><tr><td>1</td><td>发送设备仍有待发送的数据，接收设备应继续监听</td></tr><tr><td>0</td><td>发送设备无待发送数据，接收设备可进入低功耗模式</td></tr></tbody></table><h4 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h4><h5 id="信标帧（Beacon-Frame）"><a href="#信标帧（Beacon-Frame）" class="headerlink" title="信标帧（Beacon Frame）"></a>信标帧（Beacon Frame）</h5><ul><li>仅在信标帧（Beacon Frame）或在 <strong>信标使能 PAN</strong>（beacon-enabled PAN）内的 <strong>CAP 时段</strong> 发送的数据帧中使用。  </li><li>在 <strong>非信标使能 PAN</strong>（nonbeacon-enabled PAN）中，可在任意时间使用该字段。</li></ul><h5 id="低能耗（LE）CSL-模式"><a href="#低能耗（LE）CSL-模式" class="headerlink" title="低能耗（LE）CSL 模式"></a>低能耗（LE）CSL 模式</h5><ul><li>若 <code>Frame Pending = 1</code>，表示发送设备仍有数据，并期望接收设备保持射频（RF）开启，直到 <code>Frame Pending</code> 变为 0。</li></ul><h5 id="TSCH-模式"><a href="#TSCH-模式" class="headerlink" title="TSCH 模式"></a>TSCH 模式</h5><ul><li>若 <code>Frame Pending = 1</code>，表示接收设备在 <strong>下一时隙（timeslot）</strong> 仍需保持在线，并在相同信道等待数据（若当前无调度的链路）。</li></ul><h4 id="其他情况"><a href="#其他情况" class="headerlink" title="其他情况"></a>其他情况</h4><ul><li>除上述情况外，<code>Frame Pending</code> 字段在 <strong>发送时应始终设为 0</strong>，接收时应忽略该字段。</li></ul><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="AR-字段解析"><a href="#AR-字段解析" class="headerlink" title="AR 字段解析"></a>AR 字段解析</h3><h4 id="字段功能-2"><a href="#字段功能-2" class="headerlink" title="字段功能"></a>字段功能</h4><p><code>AR</code>（Acknowledgment Request，确认请求）字段用于指定接收设备在收到数据帧（Data Frame）或 MAC 命令帧（MAC Command Frame）后，是否需要发送确认帧（Ack Frame）。</p><h4 id="字段规则"><a href="#字段规则" class="headerlink" title="字段规则"></a>字段规则</h4><table><thead><tr><th>AR 值</th><th>是否需要 Ack</th><th>适用场景</th></tr></thead><tbody><tr><td>1</td><td>需要</td><td>关键数据，MAC 命令，可靠传输</td></tr><tr><td>0</td><td>不需要</td><td>广播帧，非关键数据，低功耗场景</td></tr></tbody></table><h4 id="AR-字段的影响"><a href="#AR-字段的影响" class="headerlink" title="AR 字段的影响"></a>AR 字段的影响</h4><h5 id="提高传输可靠性"><a href="#提高传输可靠性" class="headerlink" title="提高传输可靠性"></a>提高传输可靠性</h5><p>启用 AR，发送设备可以确保数据成功到达，否则会进行重传（如果支持）。</p><h5 id="降低能耗"><a href="#降低能耗" class="headerlink" title="降低能耗"></a>降低能耗</h5><p>关闭 AR 可以减少额外的 Ack 传输，从而降低设备功耗，适用于低功耗 IoT 设备。</p><h5 id="优化信道占用"><a href="#优化信道占用" class="headerlink" title="优化信道占用"></a>优化信道占用</h5><p>在高流量网络中，避免不必要的 Ack，可以减少信道竞争，提高整体通信效率。</p><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="PAN-ID-Compression-字段解析"><a href="#PAN-ID-Compression-字段解析" class="headerlink" title="PAN ID Compression 字段解析"></a>PAN ID Compression 字段解析</h3><h4 id="字段作用"><a href="#字段作用" class="headerlink" title="字段作用"></a>字段作用</h4><p><code>PAN ID Compression</code> 字段用于指示 <strong>PAN ID（个人区域网络标识）</strong> 是否包含在 MAC 帧中，以减少数据开销。</p><h4 id="解析规则"><a href="#解析规则" class="headerlink" title="解析规则"></a>解析规则</h4><ul><li><p>当 <strong>帧版本（Frame Version）字段值</strong> 为 <code>0b00</code> 或 <code>0b01</code> 时：</p><ul><li><strong>同时包含目标地址和源地址时</strong>：<ul><li>若 <strong>目标 PAN ID 与源 PAN ID 相同</strong>，则 <code>PAN ID Compression</code> 设为 <code>1</code>，省略 <code>Source PAN ID</code> 字段。</li><li>若 <strong>目标 PAN ID 与源 PAN ID 不同</strong>，则 <code>PAN ID Compression</code> 设为 <code>0</code>，同时包含 <code>Destination PAN ID</code> 和 <code>Source PAN ID</code> 字段。</li></ul></li><li><strong>仅包含目标地址或源地址时</strong>：<ul><li><code>PAN ID Compression</code> 设为 <code>0</code>，并且该地址的 <code>PAN ID</code> 字段必须包含在 MAC 帧中。</li></ul></li></ul></li><li><p>当 <strong>帧版本字段值</strong> 为 <code>0b10</code> 时：</p><ul><li><code>PAN ID Compression</code> 字段的具体设置取决于 <strong>信标帧（Beacon Frame）、数据帧（Data Frame）、MAC 命令帧（MAC Command Frame）和确认帧（Ack Frame）</strong> 的地址格式，并遵循 <strong>表 7-2</strong> 规定的组合方式。</li><li>任何不符合 <strong>表 7-2</strong> 规定的组合方式不应生成。</li></ul></li></ul><table><thead><tr><th>Destination Address</th><th>Source Address</th><th>Destination PAN ID</th><th>Source PAN ID</th><th>PAN ID Compression</th></tr></thead><tbody><tr><td>Not Present</td><td>Not Present</td><td>Not Present</td><td>Not Present</td><td>0</td></tr><tr><td>Not Present</td><td>Not Present</td><td>Present</td><td>Not Present</td><td>1</td></tr><tr><td>Present</td><td>Not Present</td><td>Present</td><td>Not Present</td><td>0</td></tr><tr><td>Present</td><td>Not Present</td><td>Not Present</td><td>Not Present</td><td>1</td></tr><tr><td>Not Present</td><td>Present</td><td>Not Present</td><td>Present</td><td>0</td></tr><tr><td>Not Present</td><td>Present</td><td>Not Present</td><td>Not Present</td><td>1</td></tr><tr><td>Extended</td><td>Extended</td><td>Present</td><td>Not Present</td><td>0</td></tr><tr><td>Extended</td><td>Extended</td><td>Not Present</td><td>Not Present</td><td>1</td></tr><tr><td>Shorta</td><td>Shorta</td><td>Present</td><td>Present</td><td>0</td></tr><tr><td>Shorta</td><td>Extended</td><td>Present</td><td>Present</td><td>0</td></tr><tr><td>Extended</td><td>Shorta</td><td>Present</td><td>Present</td><td>0</td></tr><tr><td>Shorta</td><td>Extended</td><td>Present</td><td>Not Present</td><td>1</td></tr><tr><td>Extended</td><td>Shorta</td><td>Present</td><td>Not Present</td><td>1</td></tr><tr><td>Shorta</td><td>Shorta</td><td>Present</td><td>Not Present</td><td>1</td></tr></tbody></table><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><table><thead><tr><th>PAN ID Compression 值</th><th>含义</th></tr></thead><tbody><tr><td>1</td><td>目标 PAN ID 与源 PAN ID 相同，省略 <code>Source PAN ID</code></td></tr><tr><td>0</td><td>目标 PAN ID 与源 PAN ID 不同，需包含 <code>Destination PAN ID</code> 和 <code>Source PAN ID</code></td></tr></tbody></table><p>该字段的使用可以有效减少 MAC 帧长度，优化网络通信效率。📡</p><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="Sequence-Number-Suppression-字段"><a href="#Sequence-Number-Suppression-字段" class="headerlink" title="Sequence Number Suppression 字段"></a>Sequence Number Suppression 字段</h3><h4 id="字段作用-1"><a href="#字段作用-1" class="headerlink" title="字段作用"></a>字段作用</h4><p><code>Sequence Number Suppression</code> 字段用于指示是否压制帧中的 <strong>Sequence Number（序列号）</strong> 字段。</p><table><thead><tr><th>Sequence Number Suppression 值</th><th>含义</th></tr></thead><tbody><tr><td>1</td><td>序列号字段被压制，省略序列号</td></tr><tr><td>0</td><td>序列号字段存在</td></tr></tbody></table><ul><li><strong>特殊情况：</strong><ul><li>如果 <strong>Frame Version（帧版本）字段</strong> 的值为 <code>0b00</code> 或 <code>0b01</code>，则 <code>Sequence Number Suppression</code> 字段必须为 <code>0</code>，即 <strong>序列号字段必须存在</strong>。</li></ul></li></ul><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="IE-Present-字段"><a href="#IE-Present-字段" class="headerlink" title="IE Present 字段"></a>IE Present 字段</h3><h4 id="字段作用-2"><a href="#字段作用-2" class="headerlink" title="字段作用"></a>字段作用</h4><p><code>IE Present</code> 字段用于指示帧中是否包含 <strong>Information Elements (IEs)</strong>。</p><table><thead><tr><th>IE Present 值</th><th>含义</th></tr></thead><tbody><tr><td>1</td><td>帧中包含 IEs</td></tr><tr><td>0</td><td>帧中不包含 IEs</td></tr></tbody></table><ul><li><strong>特殊情况：</strong><ul><li>如果 <strong>Frame Version（帧版本）字段</strong> 的值为 <code>0b00</code> 或 <code>0b01</code>，则 <code>IE Present</code> 字段必须为 <code>0</code>，即帧中不包含 IEs。</li></ul></li></ul><p>此字段的设置对于确定帧的内容和处理方式非常重要。📦</p><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="Destination-Addressing-Mode-字段"><a href="#Destination-Addressing-Mode-字段" class="headerlink" title="Destination Addressing Mode 字段"></a>Destination Addressing Mode 字段</h3><h4 id="字段作用-3"><a href="#字段作用-3" class="headerlink" title="字段作用"></a>字段作用</h4><p><code>Destination Addressing Mode</code> 字段用于指定帧的目标地址模式。此字段的值可以根据不同的帧类型和版本来决定帧的地址格式。</p><h4 id="解析规则-1"><a href="#解析规则-1" class="headerlink" title="解析规则"></a>解析规则</h4><ul><li><p><strong>Destination Addressing Mode</strong> 字段应设置为 <strong>Table 7-3</strong> 中列出的值之一。</p></li><li><p>如果 <strong>Destination Addressing Mode</strong> 字段的值为 <code>0</code> 且 <strong>Frame Type（帧类型）字段</strong> 指定为 <strong>Data frame</strong> 或 <strong>MAC command</strong> 且 <strong>Frame Version（帧版本）字段</strong> 为 <code>0b00</code> 或 <code>0b01</code>：</p><ul><li><strong>Source Addressing Mode（源地址模式）字段</strong> 必须为非零值，表示帧是发送给 <strong>PAN coordinator</strong>，并且帧中的 <strong>Source PAN ID</strong> 字段指定了 PAN ID。</li></ul></li><li><p>对于帧版本为 <code>0b10</code> 的情况：</p><ul><li><strong>Destination Address</strong> 或 <strong>Destination PAN ID</strong> 或两者可能会被省略。</li></ul></li></ul><table><thead><tr><th>b1</th><th>b0</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>PAN ID and address fields are not present.</td></tr><tr><td>0</td><td>1</td><td>Reserved</td></tr><tr><td>1</td><td>0</td><td>Address field contains a short address (16 bit).</td></tr><tr><td>1</td><td>1</td><td>Address field contains an extended address (64 bit).</td></tr></tbody></table><h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><table><thead><tr><th>Destination Addressing Mode 值</th><th>含义</th></tr></thead><tbody><tr><td><code>0</code></td><td>指定源地址信息，并且帧是发送给 PAN 协调器。</td></tr><tr><td>其他值</td><td>由 Table 7-3 定义，决定目标地址模式。</td></tr></tbody></table><p>此字段定义了如何在数据帧中表示目标地址，影响帧的传输和处理。📡</p><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="Frame-Version-字段"><a href="#Frame-Version-字段" class="headerlink" title="Frame Version 字段"></a>Frame Version 字段</h3><h4 id="字段作用-4"><a href="#字段作用-4" class="headerlink" title="字段作用"></a>字段作用</h4><p><code>Frame Version</code> 字段是一个无符号整数，用于指定与帧对应的版本号。所有帧类型都应按照各自子条款中描述的方式设置 <strong>Frame Version</strong> 字段。</p><h4 id="版本总结"><a href="#版本总结" class="headerlink" title="版本总结"></a>版本总结</h4><ul><li><strong>Frame Version</strong> 字段决定了帧的版本号。</li><li>每种帧类型有不同的版本号要求，这些要求在 <strong>Table 7-4</strong> 中进行了总结。</li></ul><h4 id="版本适用性"><a href="#版本适用性" class="headerlink" title="版本适用性"></a>版本适用性</h4><p>每个帧类型的适用版本总结如下：</p><table><thead><tr><th>Frame Version</th><th>适用的帧类型</th></tr></thead><tbody><tr><td><code>0b00</code></td><td>适用于特定帧类型，具体请参考 Table 7-4</td></tr><tr><td><code>0b01</code></td><td>适用于特定帧类型，具体请参考 Table 7-4</td></tr><tr><td><code>0b10</code></td><td>适用于特定帧类型，具体请参考 Table 7-4</td></tr></tbody></table><table><thead><tr><th>Frame Type</th><th>Frame Version 0b00</th><th>Frame Version 0b01</th><th>Frame Version 0b10</th><th>Frame Version 0b11</th></tr></thead><tbody><tr><td>Beacon</td><td>IEEE Std 802.15.4-2003</td><td>IEEE Std 802.15.4-2006</td><td>IEEE Std 802.15.4</td><td>Reserved</td></tr><tr><td>Data</td><td>IEEE Std 802.15.4-2003</td><td>IEEE Std 802.15.4-2006</td><td>IEEE Std 802.15.4</td><td>Reserved</td></tr><tr><td>Acknowledgment</td><td>IEEE Std 802.15.4-2003</td><td>IEEE Std 802.15.4-2006</td><td>IEEE Std 802.15.4</td><td>Reserved</td></tr><tr><td>MAC Command</td><td>IEEE Std 802.15.4-2003</td><td>IEEE Std 802.15.4-2006</td><td>IEEE Std 802.15.4</td><td>Reserved</td></tr><tr><td>Reserved</td><td>—</td><td>—</td><td>—</td><td>—</td></tr><tr><td>Multipurpose</td><td>IEEE Std 802.15.4</td><td>Reserved</td><td>Reserved</td><td>Reserved</td></tr><tr><td>Fragment</td><td>Frame Version field not present in frame</td><td>Frame Version field not present in frame</td><td>Frame Version field not present in frame</td><td>Frame Version field not present in frame</td></tr><tr><td>Extended</td><td>Frame Version field not present in frame</td><td>Frame Version field not present in frame</td><td>Frame Version field not present in frame</td><td>Frame Version field not present in frame</td></tr></tbody></table><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="Source-Addressing-Mode-field"><a href="#Source-Addressing-Mode-field" class="headerlink" title="Source Addressing Mode field"></a>Source Addressing Mode field</h3><ul><li><strong>Source Addressing Mode</strong> 字段的值应设置为 <strong>Table 7-3</strong> 中列出的值之一。</li><li>当该字段为 <code>0</code> 且 <strong>Frame Type</strong> 字段指定为 <strong>Data frame</strong> 或 <strong>MAC command</strong>，并且 <strong>Frame Version</strong> 字段为 <code>0b00</code> 或 <code>0b01</code>，则 <strong>Destination Addressing Mode</strong> 字段必须为非零。</li><li>这种情况下，意味着该帧源自 <strong>PAN coordinator</strong>，其 <strong>PAN ID</strong> 由 <strong>Destination PAN ID</strong> 字段指定。</li></ul><hr><h3 id="Sequence-Number-field"><a href="#Sequence-Number-field" class="headerlink" title="Sequence Number field"></a>Sequence Number field</h3><ul><li><strong>Sequence Number</strong> 字段用于指定该帧的序列标识符。</li><li>对于 <strong>Beacon frame</strong>，该字段指定 <strong>BSN (Beacon Sequence Number)</strong>。</li><li>对于其他帧，该字段指定 <strong>DSN (Data Sequence Number)</strong>。</li></ul><hr><h3 id="Destination-PAN-ID-field"><a href="#Destination-PAN-ID-field" class="headerlink" title="Destination PAN ID field"></a>Destination PAN ID field</h3><ul><li><strong>Destination PAN ID</strong> 字段（如果存在）是一个无符号整数，指定目标设备所在的 <strong>PAN ID</strong>。</li><li>如果该字段的值为 <strong>广播 PAN ID</strong>（定义见 6.1），则所有当前监听该信道的设备都将其视为有效 <strong>PAN ID</strong>。</li></ul><hr><h3 id="Destination-Address-field"><a href="#Destination-Address-field" class="headerlink" title="Destination Address field"></a>Destination Address field</h3><ul><li><strong>Destination Address</strong> 字段（如果存在）用于指定帧的接收者地址。</li><li>其长度由 <strong>Frame Control</strong> 字段的 <strong>Destination Addressing Mode</strong>（见 7.2.1.8）决定。</li><li>如果该字段的值为 <strong>广播短地址</strong>（定义见 6.1），则所有当前监听该信道的设备都将其视为有效地址。</li><li>该字段仅在 <strong>Destination Addressing Mode</strong> 字段非零时才包含在 MAC 帧中。</li></ul><hr><h3 id="Source-PAN-ID-field"><a href="#Source-PAN-ID-field" class="headerlink" title="Source PAN ID field"></a>Source PAN ID field</h3><ul><li><strong>Source PAN ID</strong> 字段（如果存在）用于指定该帧的发送者所属于的 <strong>PAN ID</strong>。</li><li>设备的 <strong>PAN ID</strong> 初始由其加入 <strong>PAN</strong> 时决定，但可能会因 <strong>PAN ID 冲突解决</strong>（见 6.3.2）而发生变化。</li></ul><hr><h3 id="Source-Address-field"><a href="#Source-Address-field" class="headerlink" title="Source Address field"></a>Source Address field</h3><ul><li><strong>Source Address</strong> 字段（如果存在）用于指定该帧的发送者地址。</li><li>该字段仅在 <strong>Source Addressing Mode</strong> 字段非零时才包含在 <strong>MAC 帧</strong> 中。</li></ul><hr><h3 id="Auxiliary-Security-Header-field"><a href="#Auxiliary-Security-Header-field" class="headerlink" title="Auxiliary Security Header field"></a>Auxiliary Security Header field</h3><ul><li><strong>Auxiliary Security Header</strong> 字段包含用于 <strong>安全处理</strong> 所需的信息。</li><li>该字段仅在 <strong>Security Enabled</strong> 字段设为 <code>1</code> 时才会存在。</li><li><strong>Auxiliary Security Header</strong> 字段的格式详见 <strong>9.4</strong>。</li></ul><hr><h3 id="IE-Field"><a href="#IE-Field" class="headerlink" title="IE Field"></a>IE Field</h3><ul><li><strong>IE（Information Element）字段</strong> 为可变长度，包含一个或多个 <strong>IE</strong>。</li><li>由 <strong>Header IE</strong> 和 <strong>Payload IE</strong> 子字段组成。</li><li>该字段仅在 <strong>Frame Control</strong> 字段中的 <strong>IE Present</strong> 设为 <code>1</code> 时才会存在。</li><li>每个 <strong>IE</strong> 由 <strong>描述符（descriptor）</strong> 和 <strong>可选负载（optional payload）</strong> 组成，具体描述见 <strong>7.4</strong>。</li></ul><h4 id="Header-IE"><a href="#Header-IE" class="headerlink" title="Header IE"></a>Header IE</h4><ul><li><strong>Header IE</strong>（如果存在）位于 <strong>Auxiliary Security Header</strong> 之后，属于 <strong>MHR（MAC Header）</strong>。</li></ul><h4 id="Payload-IE"><a href="#Payload-IE" class="headerlink" title="Payload IE"></a>Payload IE</h4><ul><li><strong>Payload IE</strong>（如果存在）位于 <strong>MHR</strong> 之后，属于 <strong>MAC payload</strong>，即 <strong>Payload IE</strong> 可能被加密。</li></ul><table><thead><tr><th>Octets</th><th>Variable … Variable</th><th>0&#x2F;2</th><th>Variable … Variable</th><th>0&#x2F;2</th></tr></thead><tbody><tr><td>Field</td><td>Header IE #1 … Header IE #n</td><td>Header Termination IE</td><td>Payload IE #1 … Payload IE #m</td><td>Payload Termination IE</td></tr></tbody></table><hr><h3 id="7-2-9-Frame-Payload-Field"><a href="#7-2-9-Frame-Payload-Field" class="headerlink" title="7.2.9 Frame Payload Field"></a>7.2.9 Frame Payload Field</h3><ul><li><strong>Frame Payload 字段</strong> 包含特定于各帧类型的信息。</li><li>如果 <strong>Security Enabled</strong> 字段设为 <code>1</code>，则 <strong>Frame Payload</strong> 可能受到 <strong>加密保护</strong>，详见 <strong>Clause 9</strong>。</li></ul><hr><h3 id="7-2-10-FCS-Field"><a href="#7-2-10-FCS-Field" class="headerlink" title="7.2.10 FCS Field"></a>7.2.10 FCS Field</h3><ul><li><strong>FCS（Frame Check Sequence）字段</strong> 包含一个 <strong>16-bit ITU-T CRC</strong> 或 <strong>32-bit CRC</strong>（符合 <strong>ANSI X3.66-1979.13</strong>）。</li><li><strong>FCS 计算范围</strong> 包括 <strong>MHR</strong> 和 <strong>MAC Payload</strong>，统称为 <strong>计算字段（Calculation Field）</strong>。</li><li>兼容 <strong>SUN PHYs</strong> 或 <strong>TVWS PHYs</strong> 的设备必须实现 <strong>4-octet FCS</strong>。</li></ul><hr style="border: 2px solid #000; margin: 20px 0;"><h3 id="7-4-1-IE-List-Termination"><a href="#7-4-1-IE-List-Termination" class="headerlink" title="7.4.1 IE List Termination"></a>7.4.1 IE List Termination</h3><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><ul><li>在确定 <strong>Header IEs</strong> 或 <strong>Payload IEs</strong> 是否需要终止时，<strong>不考虑</strong> 认证或加密过程。</li><li><strong>下面的table</strong> 规定了 terminate IE ：<ul><li><strong>HT1</strong>（Header Termination 1 IE），定义见 <strong>7.4.2.17</strong>。</li><li><strong>HT2</strong>（Header Termination 2 IE），定义见 <strong>7.4.2.18</strong>。</li></ul></li></ul><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><blockquote><p><strong>Header Termination IE 必须出现在 Payload IEs 之前</strong>，因为 <strong>Header IEs</strong> 和 <strong>Payload IEs</strong> <strong>共享地址空间</strong>，无法直接区分二者的边界。因此，需要使用 <strong>Header Termination IE</strong> 来标识 <strong>Header IEs 的结束</strong> 和 <strong>Payload IEs 的开始</strong>。</p></blockquote><table><thead><tr><th>Header IEs Present</th><th>Payload IEs Present</th><th>Data Payload Present</th><th>Header Termination IE Included</th><th>Payload Termination IE Included</th><th>Notes</th></tr></thead><tbody><tr><td>No</td><td>No</td><td>No</td><td>None</td><td>None</td><td>No IE lists present, hence no termination. Included here for completeness.</td></tr><tr><td>Yes</td><td>No</td><td>No</td><td>None</td><td>None</td><td>No termination is required because the end of the frame can be determined from the frame length and FCS length.</td></tr><tr><td>No</td><td>Yes</td><td>No</td><td>HT1 required</td><td>Optional</td><td>Header Termination IE 1 is required to signal end of the MHR and beginning of the Payload IE list.</td></tr><tr><td>Yes</td><td>Yes</td><td>No</td><td>HT1 required</td><td>Optional</td><td>Header Termination IE 1 is required while the Payload IE Termination is not required, but is allowed.</td></tr><tr><td>No</td><td>No</td><td>Yes</td><td>None</td><td>None</td><td>No IE lists present, hence no termination. Included here for completeness.</td></tr><tr><td>Yes</td><td>No</td><td>Yes</td><td>HT2 required</td><td>None</td><td>Header Termination IE 2 is used to signal end of the MHR and beginning of the MAC Payload.</td></tr><tr><td>No</td><td>Yes</td><td>Yes</td><td>HT1 required</td><td>Required</td><td>—</td></tr><tr><td>Yes</td><td>Yes</td><td>Yes</td><td>HT1 required</td><td>Required</td><td>—</td></tr></tbody></table><hr><h5 id="header-ie"><a href="#header-ie" class="headerlink" title="header ie"></a>header ie</h5><p>HT1 &#x2F; HT2 ie 也使用了下表的格式，只不过 content len &#x3D; 0, ElementID &#x3D; 0x7E&#x2F;7F;</p><p>Element ID 的使用，直接就代表了具体的 header ie,  而 payload IE 中的 Group ID 则代表了更多无限的可能 ～ Group 下还有 Nest IE ～ sub-ID</p><table><thead><tr><th>Bits</th><th>0–6</th><th>7–14</th><th>15</th><th>0–127</th></tr></thead><tbody><tr><td>Field</td><td>Length</td><td>Element ID</td><td>Type &#x3D; 0</td><td>Content</td></tr></tbody></table><h5 id="payload-ie"><a href="#payload-ie" class="headerlink" title="payload ie"></a>payload ie</h5><table><thead><tr><th>Bits</th><th>0–10</th><th>11–14</th><th>15</th><th>0–2047</th></tr></thead><tbody><tr><td>Field</td><td>Length</td><td>Group ID</td><td>Type &#x3D; 1</td><td>Content</td></tr></tbody></table><h6 id="nested-short-long-ie-payload-ie-group-Id-mlme-0x1"><a href="#nested-short-long-ie-payload-ie-group-Id-mlme-0x1" class="headerlink" title="nested short&#x2F;long ie ~ payload ie ~ group Id &#x3D; mlme(0x1)"></a>nested short&#x2F;long ie ~ payload ie ~ group Id &#x3D; mlme(0x1)</h6><p>nested ie 下又分出了很多 sub id ie</p><table><thead><tr><th>Bits</th><th>0–7</th><th>8–14</th><th>15</th><th>0–255</th></tr></thead><tbody><tr><td>Field</td><td>Length</td><td>Sub-ID</td><td>Type &#x3D; 0</td><td>Content</td></tr></tbody></table><table><thead><tr><th>Bits</th><th>0–10</th><th>11–14</th><th>15</th><th>0–2047</th></tr></thead><tbody><tr><td>Field</td><td>Length</td><td>Sub-ID</td><td>Type &#x3D; 0</td><td>Content</td></tr></tbody></table><hr style="border: 2px solid #000; margin: 20px 0;"><hr style="border: 2px solid #000; margin: 20px 0;"><p>主要介绍了 802.15.4 具体的 frm type 对应的 mac frm formats</p><p><strong>beacon frm</strong></p><center><img src="/../images/802-15-4-mac-frm/4_beacon_frm.png" width="800px"></center><p><strong>data frm</strong></p><center><img src="/../images/802-15-4-mac-frm/5_data_frm.png" width="800px"></center><p><strong>ack frm</strong></p><center><img src="/../images/802-15-4-mac-frm/6_imm_ack.png" width="400px"></center><center><img src="/../images/802-15-4-mac-frm/7_enh_ack.png" width="800px"></center><p><strong>mac cmd frm</strong></p><center><img src="/../images/802-15-4-mac-frm/8_mac_cmd.png" width="800px"></center><p><strong>multipurpose frm</strong></p><center><img src="/../images/802-15-4-mac-frm/9_multi.png" width="800px"></center><p><strong>ext frm</strong></p><center><img src="/../images/802-15-4-mac-frm/10_ext.png" width="600px"></center>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;主要介绍了 802.15.4 mac layer pdu 形式与各 bit 含义, 及各 field 内容&lt;/p&gt;
&lt;hr style=&quot;border: 2px solid #000; margin: 20px 0;&quot;&gt;

&lt;h2 id=&quot;General-MAC-frame</summary>
      
    
    
    
    <category term="802.15.4" scheme="http://example.com/categories/802-15-4/"/>
    
    
    <category term="802.15.4" scheme="http://example.com/tags/802-15-4/"/>
    
  </entry>
  
  <entry>
    <title>802.15.4-sec_related</title>
    <link href="http://example.com/wiki/802-15-4-sec-related/"/>
    <id>http://example.com/wiki/802-15-4-sec-related/</id>
    <published>2025-03-08T02:54:19.000Z</published>
    <updated>2025-03-18T00:47:36.545Z</updated>
    
    <content type="html"><![CDATA[<p>以 drawio 流程图的形式介绍了 802.15.4(2015) mac layer 的加解密，主要有：incoming frm dec, outcoming frm enc, secure related PIBs。</p><p><em>注：802.15.4 2015&#x2F;2006&#x2F;2003 版本加解密flow上存在差异,点击流程图可以全屏展开</em></p><hr style="border: 2px solid #000; margin: 20px 0;"><h2 id="outgoing-frm-enc"><a href="#outgoing-frm-enc" class="headerlink" title="outgoing frm - enc"></a>outgoing frm - enc</h2><iframe src="https://muyin568.github.io/drawio_htmls/incoming_dec-enc-2015.drawio.html" width="125%" height="300"></iframe><br/><hr><h2 id="incoming-frm-sec-on-dec"><a href="#incoming-frm-sec-on-dec" class="headerlink" title="incoming frm - sec on - dec"></a>incoming frm - sec on - dec</h2><iframe src="https://muyin568.github.io/drawio_htmls/incoming_dec-dec-secOn-2015.drawio.html" width="125%" height="300"></iframe><br/><hr><h2 id="incoming-frm-sec-on-dec-1"><a href="#incoming-frm-sec-on-dec-1" class="headerlink" title="incoming frm - sec on - dec"></a>incoming frm - sec on - dec</h2><iframe src="https://muyin568.github.io/drawio_htmls/incoming_dec-dec-secOff-2015.drawio.html" width="125%" height="300"></iframe><br/><hr><h2 id="sec-pib-related"><a href="#sec-pib-related" class="headerlink" title="sec pib related"></a>sec pib related</h2><iframe src="https://muyin568.github.io/drawio_htmls/incoming_dec-sec-pib-2015.drawio.html" width="125%" height="400"></iframe><br/>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;以 drawio 流程图的形式介绍了 802.15.4(2015) mac layer 的加解密，主要有：incoming frm dec, outcoming frm enc, secure related PIBs。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;注：802.15.4 2015</summary>
      
    
    
    
    <category term="802.15.4" scheme="http://example.com/categories/802-15-4/"/>
    
    
    <category term="802.15.4" scheme="http://example.com/tags/802-15-4/"/>
    
  </entry>
  
</feed>
