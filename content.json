{"pages":[{"title":"About","date":"2025-03-11T14:11:10.173Z","path":"about/index.html","text":""},{"title":"categories","date":"2025-03-12T00:21:03.000Z","path":"categories/index.html","text":""},{"title":"Tags","date":"2025-03-12T23:44:41.796Z","path":"tags/index.html","text":""}],"posts":[{"title":"802.15.4-mac_services","date":"2025-03-27T00:35:47.000Z","path":"wiki/802-15-4-mac-services/","text":"ä»‹ç»äº† 802.15.4(2015) mac layer services, åŒ…æ‹¬ genernal review mlme &#x2F; mcps &#x2F; mac constans &amp;&amp; mac pib ã€‚ MAC å±‚ï¼ˆåª’ä½“è®¿é—®æ§åˆ¶å±‚ï¼‰è´Ÿè´£åè°ƒè®¾å¤‡ä¹‹é—´çš„æ— çº¿é€šä¿¡ï¼Œå¹¶åˆ†ä¸ºä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š 1. MAC å±‚ç®¡ç†å®ä½“ï¼ˆMLME, MAC Layer Management Entityï¼‰ 2. MAC å…¬å…±éƒ¨åˆ†å­å±‚ï¼ˆMCPS, MAC Common Part Sublayerï¼‰ SAP çš„æ¦‚å¿µåœ¨ IEEE 802.15.4 æ ‡å‡†ä¸­ï¼ŒSAPï¼ˆæœåŠ¡è®¿é—®ç‚¹ï¼‰ æ˜¯ä¸åŒåè®®å±‚ä¹‹é—´çš„æ¥å£ï¼Œç”¨äºæ•°æ®ä¼ è¾“å’Œç®¡ç†æ§åˆ¶ã€‚SAP å…è®¸åè®®æ ˆçš„ä¸åŒå±‚ä¹‹é—´äº¤æ¢æ•°æ®å’Œå‘½ä»¤ï¼Œä¾‹å¦‚ MCPS-SAP å’Œ MLME-SAPã€‚ SAP çš„ä½œç”¨åœ¨åè®®æ ˆä¸­ï¼Œä¸åŒå±‚çš„åŠŸèƒ½ä¸åŒï¼Œè€Œ SAP ä½œä¸ºæ¥å£ï¼Œæä¾›æ ‡å‡†åŒ–çš„äº¤äº’æ–¹å¼ï¼Œä¾‹å¦‚ï¼š åº”ç”¨å±‚ â†”ï¸ ç½‘ç»œå±‚ é€šè¿‡ NLDE-SAPï¼ˆç½‘ç»œå±‚æ•°æ®å®ä½“ SAPï¼‰ äº¤æ¢æ•°æ®ã€‚ ç½‘ç»œå±‚ â†”ï¸ MAC å±‚ é€šè¿‡ NLME-SAPï¼ˆç½‘ç»œå±‚ç®¡ç†å®ä½“ SAPï¼‰ è¿›è¡Œç®¡ç†æ“ä½œã€‚ MAC å±‚ â†”ï¸ ç‰©ç†å±‚ é€šè¿‡ PLME-SAPï¼ˆç‰©ç†å±‚ç®¡ç†å®ä½“ SAPï¼‰ è¿›è¡Œé€šä¿¡ã€‚ 802.15.4 ä¸­å¸¸è§çš„ SAP SAP åç§° ä½œç”¨ æ¶‰åŠå±‚ MCPS-SAPï¼ˆMAC Common Part Sublayer Service Access Pointï¼‰ å¤„ç† MAC å±‚æ•°æ®ä¼ è¾“ MAC å±‚ â†”ï¸ ä¸Šå±‚ MLME-SAPï¼ˆMAC Layer Management Entity Service Access Pointï¼‰ å¤„ç† MAC å±‚ç®¡ç†åŠŸèƒ½ï¼ˆå¦‚ä¿¡æ ‡ã€å…³è”ï¼‰ MAC å±‚ â†”ï¸ ä¸Šå±‚ PLME-SAPï¼ˆPhysical Layer Management Entity Service Access Pointï¼‰ ç‰©ç†å±‚ç®¡ç†ï¼ˆå¦‚ä¿¡é“è®¾ç½®ï¼‰ ç‰©ç†å±‚ â†”ï¸ MAC å±‚ PD-SAPï¼ˆPhysical Data Service Access Pointï¼‰ ç‰©ç†å±‚æ•°æ®ä¼ è¾“ ç‰©ç†å±‚ â†”ï¸ MAC å±‚ SAP çš„å·¥ä½œæ–¹å¼SAP ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œäº¤äº’ï¼š ind + resp ; req + confirm Indicationï¼ˆæŒ‡ç¤ºï¼‰ï¼šä¸‹å±‚é€šçŸ¥ä¸Šå±‚æŸä¸ªäº‹ä»¶å‘ç”Ÿï¼ˆå¦‚æ”¶åˆ°æ•°æ®ï¼‰ã€‚ Responseï¼ˆå“åº”ï¼‰ï¼šä¸Šå±‚å¯¹æŸä¸ªè¯·æ±‚çš„å›åº”ï¼ˆå¦‚å…³è”è¯·æ±‚çš„ç¡®è®¤ï¼‰ã€‚ Requestï¼ˆè¯·æ±‚ï¼‰ï¼šä¸Šå±‚è¯·æ±‚ä¸‹å±‚æ‰§è¡ŒæŸé¡¹æ“ä½œï¼ˆå¦‚å‘é€æ•°æ®ï¼‰ã€‚ Confirmï¼ˆç¡®è®¤ï¼‰ï¼šä¸‹å±‚åé¦ˆè¯·æ±‚çš„æ‰§è¡Œç»“æœï¼ˆå¦‚æ•°æ®å‘é€æˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚ SAP ç¤ºä¾‹ï¼ˆMCPS-DATA å‘é€æµç¨‹ï¼‰å‡è®¾ä¸€ä¸ªè®¾å¤‡è¦å‘é€æ•°æ®ï¼ŒSAP äº¤äº’æµç¨‹å¦‚ä¸‹ï¼š ä¸Šå±‚è°ƒç”¨ MCPS-DATA.requestï¼Œè¯·æ±‚ MAC å±‚å‘é€æ•°æ®ã€‚ MAC å±‚å¤„ç† è¯¥è¯·æ±‚ï¼Œå¹¶é€šè¿‡ç‰©ç†å±‚å‘é€æ•°æ®ã€‚ å¦‚æœå¯¹æ–¹æ”¶åˆ°æ•°æ®å¹¶å›å¤ ACKï¼ŒMAC å±‚ç”Ÿæˆ MCPS-DATA.confirm åé¦ˆç»™ä¸Šå±‚ï¼Œè¡¨ç¤ºå‘é€æˆåŠŸã€‚ å¦‚æœå¯¹æ–¹æœªå“åº”ï¼ŒMAC å±‚å¯èƒ½ä¼šé‡ä¼ ï¼Œæœ€ç»ˆç»™å‡º MCPS-DATA.confirmï¼Œé€šçŸ¥ä¸Šå±‚å‘é€æˆåŠŸæˆ–å¤±è´¥ã€‚ MLME primtivesMLME-SAPï¼ˆMAC å±‚ç®¡ç†å®ä½“æœåŠ¡è®¿é—®ç‚¹ï¼‰æ¥å£ç”¨äºä¸Šå±‚ä¸ MAC å±‚ä¹‹é—´çš„ç®¡ç†äº¤äº’ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„ åŸè¯­ï¼ˆprimitivesï¼‰ï¼Œç”¨äºæ‰§è¡Œç½‘ç»œç®¡ç†ã€é…ç½®ä»¥åŠæ§åˆ¶æ“ä½œã€‚åŒ…æ‹¬è®¾å¤‡çš„åŠ å…¥&#x2F;é€€å‡ºç½‘ç»œã€æ‰«æã€åŒæ­¥ã€å‚æ•°è®¾ç½®ã€ä¿¡æ ‡é€šçŸ¥ç­‰ã€‚è¿™äº›åŸè¯­æ˜¯ MAC MLME çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå¸®åŠ©è®¾å¤‡ä¸ç½‘ç»œåè°ƒå·¥ä½œï¼Œç¡®ä¿ PAN çš„æ­£å¸¸è¿è¡Œã€‚ common æƒ…å†µå¤„ç†(MLME å¤„ç† higher layer å†…å®¹æ—¶å‡ºç°é—®é¢˜)é”™è¯¯å¤„ç†ï¼ˆRequestï¼ˆè¯·æ±‚ï¼‰ï¼‰ å¦‚æœåœ¨ è¯·æ±‚åŸè¯­ çš„ å‘é€å¸§å®‰å…¨å¤„ç†ï¼ˆå¦‚ 9.2.1 æ‰€è¿°ï¼‰ä¸­å‘ç”Ÿä»»ä½•é”™è¯¯ï¼ŒMLME ä¼šä¸¢å¼ƒè¯¥å¸§ï¼Œå¹¶ä½¿ç”¨ç›¸åº”çš„ç¡®è®¤åŸè¯­ï¼Œè¿”å› å‘é€å¸§å®‰å…¨å¤„ç† ä¸­çš„é”™è¯¯ã€‚ é”™è¯¯å¤„ç†ï¼ˆResponseï¼ˆå“åº”ï¼‰ï¼‰ å¦‚æœåœ¨ å“åº”åŸè¯­ çš„ å‘é€å¸§å®‰å…¨å¤„ç†ï¼ˆå¦‚ 9.2.1 æ‰€è¿°ï¼‰ä¸­å‘ç”Ÿä»»ä½•é”™è¯¯ï¼ŒMLME ä¼šä¸¢å¼ƒè¯¥å¸§ï¼Œå¹¶ä½¿ç”¨ MLME-COMM-STATUS.indication åŸè¯­ï¼Œè¿”å› å‘é€å¸§å®‰å…¨å¤„ç† ä¸­çš„é”™è¯¯ã€‚ å‚æ•°æ— æ•ˆæˆ–è¶…å‡ºèŒƒå›´ å¦‚æœ è¯·æ±‚åŸè¯­ ä¸­çš„ä»»ä½•å‚æ•°ä¸å—æ”¯æŒæˆ–è¶…å‡ºèŒƒå›´ï¼ŒMAC å­å±‚ ä¼šä½¿ç”¨ INVALID_PARAMETER çŠ¶æ€å€¼è¿”å›ç›¸åº”çš„ç¡®è®¤åŸè¯­ã€‚ å¦‚æœ å“åº”åŸè¯­ ä¸­çš„ä»»ä½•å‚æ•°ä¸å—æ”¯æŒæˆ–è¶…å‡ºèŒƒå›´ï¼ŒMAC å­å±‚ ä¼šä½¿ç”¨ INVALID_PARAMETER çŠ¶æ€å€¼è¿”å› MLME-COMM-STATUS.indication åŸè¯­ã€‚ CSMA-CA å¤±è´¥ å¦‚æœç”±äº CSMA-CA ç®—æ³•å¤±è´¥ï¼ŒMLME æ— æ³•å‘é€ è¯·æ±‚åŸè¯­ æ‰€éœ€çš„å¸§ï¼ŒMLME ä¼šä½¿ç”¨ CHANNEL_ACCESS_FAILURE çŠ¶æ€å€¼è¿”å›ç›¸åº”çš„ç¡®è®¤åŸè¯­ã€‚ ACK æœªæ”¶åˆ° å¦‚æœ MLME æˆåŠŸå‘é€ è¯·æ±‚åŸè¯­ æ‰€éœ€çš„å¸§ï¼Œä½†æ²¡æœ‰æ”¶åˆ°é¢„æœŸçš„ç¡®è®¤å¸§ï¼ŒMLME ä¼šä½¿ç”¨ NO_ACK çŠ¶æ€å€¼è¿”å›ç›¸åº”çš„ç¡®è®¤åŸè¯­ã€‚ å…³é”®MLMEåŸè¯­ MLME-ASSOCIATE: è®¾å¤‡è¯·æ±‚åŠ å…¥ç½‘ç»œæ—¶ä½¿ç”¨æ­¤åŸè¯­ã€‚åŒ…å«å…³è”è¯·æ±‚ã€ç¡®è®¤ã€æŒ‡ç¤ºå’Œå“åº”ã€‚è®¾å¤‡é€šè¿‡è¯¥åŸè¯­ä¸ PAN åè°ƒå™¨å»ºç«‹è¿æ¥ã€‚ MLME-SCAN: è¯¥åŸè¯­ç”¨äºå¯åŠ¨æ‰«ææ“ä½œï¼Œå¯»æ‰¾å¯ç”¨çš„ PAN ç½‘ç»œã€‚å¯ä»¥è¿›è¡Œä¸»åŠ¨æ‰«æï¼ˆå‘é€æ¢æµ‹è¯·æ±‚ï¼‰æˆ–è¢«åŠ¨æ‰«æï¼ˆæ¥æ”¶ä¿¡æ ‡ï¼‰ã€‚ MLME-SYNC: è¯¥åŸè¯­ç”¨äºè®¾å¤‡ä¸åè°ƒå™¨ä¹‹é—´çš„åŒæ­¥ï¼Œç¡®ä¿è®¾å¤‡ä¸ç½‘ç»œçš„æ—¶åºåŒæ­¥ã€‚ MLME-START: è¯¥åŸè¯­ç”¨äºåè°ƒå™¨å¯åŠ¨æˆ–é‡æ–°å¯åŠ¨ä¸€ä¸ª PANï¼Œåˆ†é…æ–°çš„ PAN IDï¼Œå¹¶å¼€å§‹ä¿¡æ ‡ä¼ è¾“ã€‚ MLME-BEACON-NOTIFY: è®¾å¤‡æ¥æ”¶åˆ° PAN åè°ƒå™¨çš„ä¿¡æ ‡æ—¶ä½¿ç”¨æ­¤åŸè¯­ï¼Œé€šçŸ¥è®¾å¤‡ä¿¡æ ‡ä¿¡æ¯ï¼Œå¦‚ç½‘ç»œåŒæ­¥ä¿¡æ¯å’Œåä½œå‚æ•°ã€‚ MLME-PROMISCUOUSMODE: è¯¥åŸè¯­å…è®¸è®¾å¤‡è¿›å…¥æ··æ‚æ¨¡å¼ï¼Œå³è®¾å¤‡å¯ä»¥æ¥æ”¶æ‰€æœ‰é¢‘æ®µä¸Šçš„æ•°æ®åŒ…ï¼Œè€Œä¸ä»…ä»…æ˜¯å±äºå…¶è‡ªå·± PAN çš„æ•°æ®åŒ…ã€‚ MLME-SET å’Œ MLME-GET: è¿™ä¸¤ä¸ªåŸè¯­ç”¨äºé…ç½®å’ŒæŸ¥è¯¢ MAC å±‚çš„å‚æ•°ï¼Œä¾‹å¦‚ PAN IDã€ä¿¡æ ‡å‘¨æœŸã€é‡è¯•æ¬¡æ•°ç­‰ã€‚ ä¸¾ä¾‹MLME-ASSOCIATE.request mlme primitive ç±»ä¼¼äº bluetooth çš„ hci cmd / hci evtï¼Œå»è¿›è¡Œä¸€äº› mac layer æ§åˆ¶ç®¡ç† ï¼Œåœ¨802.15.4 ä¸­éƒ½æœ‰è¯¦ç»†çš„å‚æ•°æè¿°è§£é‡Šå®šä¹‰ã€‚ä¸‹é¢ä¸¾ä¾‹MLME-ASSOCIATE.requestï¼š MLME-ASSOCIATE.request åŸè¯­è¯¦ç»†è§£æåœ¨ IEEE 802.15.4 æ ‡å‡†ä¸­ï¼ŒMLME-ASSOCIATE.request æ˜¯ä¸€ä¸ªç”¨äºè®¾å¤‡è¯·æ±‚åŠ å…¥ PAN ç½‘ç»œ çš„åŸè¯­ã€‚è®¾å¤‡é€šè¿‡è¯¥åŸè¯­å‘ MAC å±‚è¯·æ±‚ä¸ PAN åè°ƒå™¨ å»ºç«‹å…³è”ã€‚ MLME-ASSOCIATE.request çš„å‚æ•° MLME-ASSOCIATE.request åŸè¯­åŒ…å«ä»¥ä¸‹ä¸»è¦å‚æ•°ï¼š å‚æ•°åç§° æè¿° deviceAddress è®¾å¤‡çš„åœ°å€ï¼Œé€šå¸¸æ˜¯è®¾å¤‡çš„ MAC åœ°å€ã€‚å¯ä»¥æ˜¯ çŸ­åœ°å€ï¼ˆ16ä½ï¼‰æˆ– æ‰©å±•åœ°å€ï¼ˆ64ä½ï¼‰ã€‚ capabilityInformation è®¾å¤‡çš„èƒ½åŠ›ä¿¡æ¯ï¼Œç”¨æ¥è¡¨ç¤ºè®¾å¤‡æ˜¯å¦æ”¯æŒæŸäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œæ˜¯å¦æ”¯æŒ FFDï¼ˆFull Function Deviceï¼‰æˆ– RFDï¼ˆReduced Function Deviceï¼‰ç­‰ï¼‰ã€‚ securityLevel è¡¨ç¤ºå®‰å…¨çº§åˆ«ï¼ŒæŒ‡æ˜é€šä¿¡è¿‡ç¨‹ä¸­ä½¿ç”¨çš„åŠ å¯†æ–¹å¼åŠå¯†é’¥ç®¡ç†ã€‚ pansId æŒ‡å®šç›®æ ‡ PAN çš„ PAN IDã€‚è®¾å¤‡éœ€è¦æŒ‡å®šä¸ä¹‹å…³è”çš„ PANã€‚ assocDeviceAddress è®¾å¤‡çš„ç›®æ ‡å…³è”è®¾å¤‡çš„åœ°å€ã€‚è®¾å¤‡ä¼šå°è¯•ä¸æ­¤åœ°å€å¯¹åº”çš„ PAN åè°ƒå™¨å»ºç«‹è”ç³»ã€‚ MLME-ASSOCIATE.request çš„æ‰§è¡Œæµç¨‹ å½“ MLME-ASSOCIATE.request è¢«å‘å‡ºæ—¶ï¼ŒMAC å±‚ä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š å‚æ•°éªŒè¯MAC å±‚é¦–å…ˆéªŒè¯åŸè¯­ä¸­çš„ å‚æ•°ï¼Œä¾‹å¦‚è®¾å¤‡åœ°å€ã€èƒ½åŠ›ä¿¡æ¯ç­‰æ˜¯å¦åˆç†ã€‚å¦‚æœå‚æ•°æ— æ•ˆï¼ŒåŸè¯­å°†å¤±è´¥ã€‚ è®¿é—®æƒé™æ£€æŸ¥MAC å±‚ä¼šæ ¹æ®è®¾å¤‡çš„ç±»å‹ï¼ˆå¦‚ FFD æˆ– RFDï¼‰å’Œèƒ½åŠ›ä¿¡æ¯ï¼Œå†³å®šæ˜¯å¦å…è®¸è®¾å¤‡ä¸ç›®æ ‡ PAN åè°ƒå™¨å»ºç«‹è¿æ¥ã€‚FFD å¯ä»¥å……å½“ PAN åè°ƒå™¨ï¼Œè€Œ RFD åªèƒ½ä¸ FFD è®¾å¤‡å»ºç«‹è¿æ¥ã€‚ å‘é€å…³è”è¯·æ±‚å¦‚æœéªŒè¯é€šè¿‡ï¼ŒMAC å±‚å°†æ„é€ ä¸€ä¸ª å…³è”è¯·æ±‚å¸§ï¼ˆAssociation Request Frameï¼‰ã€‚è¯¥å¸§åŒ…å«è®¾å¤‡çš„åœ°å€ã€èƒ½åŠ›ä¿¡æ¯ç­‰æ•°æ®ï¼Œç„¶åå‘é€åˆ°ç›®æ ‡ PAN åè°ƒå™¨ã€‚ ç­‰å¾…å“åº”åè°ƒå™¨æ”¶åˆ°è¯·æ±‚åï¼Œä¼šé€šè¿‡ MLME-ASSOCIATE.response åŸè¯­å‘è®¾å¤‡å“åº”ï¼Œè¡¨æ˜å…³è”æ˜¯å¦æˆåŠŸã€‚å¦‚æœæˆåŠŸï¼Œè®¾å¤‡å°†è¢«åˆ†é…ä¸€ä¸ª PAN åœ°å€ï¼ˆå¦‚æœæ˜¯æ–°çš„è®¾å¤‡ï¼‰ã€‚ å…³è”æˆåŠŸæˆ–å¤±è´¥ å¦‚æœå…³è”æˆåŠŸï¼ŒMAC å±‚ä¼šä½¿ç”¨ MLME-ASSOCIATE.confirm å‘ä¸Šå±‚å‘é€ç¡®è®¤ï¼Œè¡¨ç¤ºè®¾å¤‡å·²ç»æˆåŠŸåŠ å…¥ç½‘ç»œã€‚ å¦‚æœå¤±è´¥ï¼ŒMAC å±‚ä¼šå‘é€å¤±è´¥æŒ‡ç¤ºï¼ˆä¾‹å¦‚ï¼Œå›  PAN ID ä¸åŒ¹é…æˆ–è®¾å¤‡èƒ½åŠ›ä¸ç¬¦åˆè¦æ±‚ï¼‰ã€‚ ä¸ PIBï¼ˆProtocol Information Baseï¼‰çš„å…³ç³» åœ¨ MLME-ASSOCIATE.request æ‰§è¡Œæ—¶ï¼ŒPIBï¼ˆåè®®ä¿¡æ¯åº“ï¼‰ä¸­çš„ç›¸å…³å‚æ•°èµ·ç€é‡è¦ä½œç”¨ã€‚PIB åŒ…å«ä¸è®¾å¤‡é…ç½®å’Œç½‘ç»œç®¡ç†ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå¯èƒ½å½±å“å…³è”è¿‡ç¨‹çš„ PIB é¡¹ç›®ï¼š macPANIdè®¾å¤‡å°†ä¼šé€šè¿‡ MLME-ASSOCIATE.request ä¸­çš„ pansId å‚æ•°å‘ç›®æ ‡åè°ƒå™¨å‘èµ·å…³è”è¯·æ±‚ï¼ŒPIB ä¸­çš„ macPANId å¿…é¡»ä¸è¯·æ±‚çš„ PAN ID åŒ¹é…ã€‚ macShortAddress å’Œ macExtendedAddressè®¾å¤‡çš„åœ°å€ä¼šé€šè¿‡ deviceAddress å‚æ•°ä¼ é€’ã€‚MAC å±‚ä¼šæ ¹æ® PIB ä¸­å­˜å‚¨çš„è®¾å¤‡åœ°å€ä¿¡æ¯æ¥å¤„ç†è®¾å¤‡çš„èº«ä»½éªŒè¯ä¸è¿æ¥ã€‚ macAssociationPermitå¦‚æœ PIB ä¸­çš„ macAssociationPermit ä¸º FALSEï¼Œå³ç¦ç”¨å…³è”ï¼ŒMAC å±‚ä¼šæ‹’ç»è®¾å¤‡çš„å…³è”è¯·æ±‚ã€‚ macBeaconOrderå¦‚æœè®¾å¤‡åœ¨æ‰«æè¿‡ç¨‹ä¸­æ£€æµ‹åˆ°çš„ä¿¡æ ‡ç¬¦åˆå…¶ macBeaconOrderï¼ˆä¿¡æ ‡å‘¨æœŸï¼‰é…ç½®ï¼ŒMAC å±‚æ‰ä¼šç»§ç»­å‘é€å…³è”è¯·æ±‚ã€‚ macDeviceTypeè®¾å¤‡çš„ç±»å‹ï¼ˆFFD æˆ– RFDï¼‰é€šè¿‡ capabilityInformation å‚æ•°ä¼ é€’ã€‚PIB ä¸­çš„ macDeviceType ä¼šå½±å“è®¾å¤‡æ˜¯å¦èƒ½æˆåŠŸåŠ å…¥ç½‘ç»œã€‚ MCPS primtivesMAC æ•°æ®æœåŠ¡ï¼ˆMAC Data Serviceï¼‰é€šè¿‡ MCPSï¼ˆMAC å±‚æ•°æ®æœåŠ¡ï¼‰æ¥å£æä¾›äº†æ•°æ®ä¼ è¾“çš„åŸºæœ¬åŠŸèƒ½ åŠŸèƒ½ å‘é€æ•°æ®ï¼šç”¨äºå°†æ•°æ®ä»å‘é€æ–¹ä¼ è¾“åˆ°æ¥æ”¶æ–¹ã€‚æ•°æ®ä¼ è¾“å¯ä»¥é€šè¿‡ ç‚¹å¯¹ç‚¹é€šä¿¡ æˆ– å¹¿æ’­ è¿›è¡Œã€‚ æ¥æ”¶æ•°æ®ï¼šMAC å±‚ä¹Ÿèƒ½å¤Ÿå¤„ç†ä»ç‰©ç†å±‚æ¥æ”¶åˆ°çš„æ•°æ®åŒ…ï¼Œå°†å…¶ä¼ é€’ç»™ä¸Šå±‚ã€‚ ä¿è¯æ•°æ®çš„å¯é æ€§ï¼šMAC å±‚é€šè¿‡é‡æ–°ä¼ è¾“æœºåˆ¶ã€ç¡®è®¤æœºåˆ¶æ¥ä¿è¯æ•°æ®çš„ä¼ è¾“å¯é æ€§ã€‚ ä¼ è¾“ç±»å‹ æ•°æ®å¸§ï¼šé€šè¿‡æ•°æ®æœåŠ¡ä¼ è¾“çš„åŸºæœ¬å•å…ƒæ˜¯æ•°æ®å¸§ï¼ˆData Frameï¼‰ï¼ŒåŒ…æ‹¬æ•°æ®çš„æœ‰æ•ˆè½½è·ã€ç›®çš„åœ°å€ã€æºåœ°å€ç­‰ä¿¡æ¯ã€‚ ç¡®è®¤ï¼ˆACKï¼‰å¸§ï¼šç”¨äºç¡®è®¤æ•°æ®å¸§çš„æ¥æ”¶ã€‚ MCPS åŸè¯­ MCPS-DATA.requestï¼šè¯·æ±‚å‘é€æ•°æ®å¸§ã€‚ MCPS-DATA.confirmï¼šç¡®è®¤æ•°æ®å‘é€çš„ç»“æœã€‚ MCPS-DATA.indicationï¼šé€šçŸ¥ä¸Šå±‚æ¥æ”¶åˆ°çš„æ•°æ®å¸§ã€‚ Purging æ“ä½œ MCPS-PURGE.requestï¼šè¯·æ±‚æ¸…é™¤æ•°æ®é˜Ÿåˆ—ä¸­çš„æœªæˆåŠŸå‘é€çš„æ•°æ®å¸§ã€‚ MCPS-PURGE.confirmï¼šç¡®è®¤æ˜¯å¦æˆåŠŸæ¸…é™¤æ•°æ®é˜Ÿåˆ—ä¸­çš„æ•°æ®å¸§ã€‚ ä¸¾ä¾‹MCPS-DATA.requeståœ¨ IEEE 802.15.4 ä¸­ï¼ŒMCPS-DATA.request æ˜¯ç”¨äºè¯·æ±‚å‘é€æ•°æ®å¸§çš„åŸè¯­ã€‚ 1. MCPS-DATA.request å‚æ•°è§£æ MCPS-DATA.request åŸè¯­çš„å‚æ•°é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š å‚æ•°åç§° æè¿° dstAddr ç›®æ ‡è®¾å¤‡åœ°å€ï¼Œé€šå¸¸ä¸º çŸ­åœ°å€ æˆ– æ‰©å±•åœ°å€ã€‚å¯ä»¥æ˜¯å•æ’­åœ°å€æˆ–å¹¿æ’­åœ°å€ã€‚ srcAddr æºè®¾å¤‡åœ°å€ï¼Œé€šå¸¸ä¸ºå‘é€è®¾å¤‡çš„ çŸ­åœ°å€ æˆ– æ‰©å±•åœ°å€ã€‚ frame è¦å‘é€çš„æ•°æ®å¸§ï¼Œå…¶ä¸­åŒ…æ‹¬æ•°æ®çš„æœ‰æ•ˆè½½è·ã€ç›®çš„åœ°å€ã€æºåœ°å€ç­‰ä¿¡æ¯ã€‚ securityLevel æ•°æ®ä¼ è¾“çš„å®‰å…¨çº§åˆ«ï¼ŒæŒ‡ç¤ºæ˜¯å¦è¿›è¡ŒåŠ å¯†ã€éªŒè¯ç­‰ã€‚æ­¤å­—æ®µå¯ä»¥å½±å“æ•°æ®å‘é€çš„å®‰å…¨æ€§ã€‚ ackRequired æ˜¯å¦è¦æ±‚æ¥æ”¶æ–¹è¿”å›ç¡®è®¤å¸§ï¼ˆACKï¼‰ã€‚å¦‚æœä¸º trueï¼ŒMAC å±‚å°†ç­‰å¾…æ¥æ”¶æ–¹çš„ ACK å“åº”ã€‚ txOptions ä¼ è¾“é€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šæ•°æ®å¸§å‘é€çš„é¢å¤–ç‰¹æ€§ï¼ˆä¾‹å¦‚æ˜¯å¦ä¸ºå¹¿æ’­å¸§ç­‰ï¼‰ã€‚ 2. MCPS-DATA.request æ‰§è¡Œæµç¨‹ 2.1 æ•°æ®å‡†å¤‡ å½“ä¸Šå±‚åº”ç”¨æˆ–åè®®æ ˆè°ƒç”¨ MCPS-DATA.request è¯·æ±‚å‘é€æ•°æ®æ—¶ï¼ŒMAC å±‚ä¼šè¿›è¡Œä»¥ä¸‹å‡†å¤‡å·¥ä½œï¼š éªŒè¯è¯·æ±‚å‚æ•°ï¼šæ£€æŸ¥ç›®æ ‡åœ°å€ã€æºåœ°å€ç­‰å­—æ®µæ˜¯å¦æœ‰æ•ˆã€‚ æ„å»ºæ•°æ®å¸§ï¼šæ ¹æ®è¯·æ±‚ä¸­çš„ frame å’Œå…¶ä»–å‚æ•°æ„å»ºæ•°æ®å¸§ã€‚è¯¥æ•°æ®å¸§åŒ…æ‹¬äº†æºåœ°å€ã€ç›®æ ‡åœ°å€ã€æœ‰æ•ˆè½½è·ã€åºåˆ—å·ç­‰ä¿¡æ¯ã€‚ æ£€æŸ¥å®‰å…¨æ€§è®¾ç½®ï¼šæ ¹æ® securityLevel å‚æ•°ï¼ŒMAC å±‚ä¼šå†³å®šæ˜¯å¦è¿›è¡Œæ•°æ®åŠ å¯†æˆ–è®¤è¯ã€‚ 2.2 ä¸ PIBï¼ˆåè®®ä¿¡æ¯åº“ï¼‰çš„å…³ç³»MAC å±‚ä¼šæŸ¥è¯¢ PIBï¼ˆProtocol Information Baseï¼‰ æ¥è·å–ä¸æ•°æ®å‘é€ç›¸å…³çš„é…ç½®ä¿¡æ¯ã€‚PIB ä¸­çš„ä¸€äº›å…³é”®å‚æ•°å½±å“æ•°æ®çš„å‘é€è¿‡ç¨‹ï¼š macPANIdï¼šç”¨äºåˆ¤æ–­æ•°æ®æ˜¯å¦å±äºç›®æ ‡ PANã€‚å¦‚æœæ•°æ®çš„ dstAddr ä¸ macPANId ä¸åŒ¹é…ï¼Œå‘é€æ“ä½œå°†å¤±è´¥ã€‚ macShortAddress å’Œ macExtendedAddressï¼šè¿™äº›å­—æ®µç”¨äºæ„å»ºæºåœ°å€å’Œç›®æ ‡åœ°å€ï¼Œç‰¹åˆ«æ˜¯è®¾å¤‡çš„ 16 ä½æˆ– 64 ä½åœ°å€ã€‚ macAckWaitDurationï¼šæ§åˆ¶æ•°æ®å¸§ç­‰å¾… ACK å“åº”çš„æ—¶é—´ã€‚å¦‚æœ ackRequired ä¸º trueï¼ŒMAC å±‚ä¼šä½¿ç”¨è¯¥é…ç½®é¡¹æ¥è®¾ç½®ç­‰å¾… ACK çš„æœ€å¤§æ—¶é•¿ã€‚ macMaxFrameRetriesï¼šå¦‚æœæ•°æ®å‘é€å¤±è´¥ï¼ŒMAC å±‚ä¼šå°è¯•é‡æ–°å‘é€ã€‚æ­¤å‚æ•°æŒ‡å®šæœ€å¤§é‡è¯•æ¬¡æ•°ã€‚ macMaxFrameSizeï¼šæ§åˆ¶å•ä¸ªæ•°æ®å¸§çš„æœ€å¤§å¤§å°ã€‚å¦‚æœæ•°æ®å¸§è¶…è¿‡æœ€å¤§å¸§å¤§å°ï¼ŒMAC å±‚å¯èƒ½ä¼šå°†æ•°æ®è¿›è¡Œåˆ†æ®µã€‚ 2.3 æ•°æ®å¸§çš„å‘é€ ç‰©ç†å±‚å‘é€ï¼šMAC å±‚ä¼šå°†æ„å»ºå¥½çš„æ•°æ®å¸§äº¤ç»™ç‰©ç†å±‚è¿›è¡Œå‘é€ã€‚ç‰©ç†å±‚è´Ÿè´£å°†æ•°æ®è½¬æ¢ä¸ºæ— çº¿ä¿¡å·å¹¶ä¼ è¾“ã€‚ 2.4 ç¡®è®¤æœºåˆ¶ å¦‚æœ ackRequired ä¸º trueï¼ŒMAC å±‚ä¼šç­‰å¾…æ¥æ”¶æ–¹å‘é€ ACK å¸§ä½œä¸ºç¡®è®¤ã€‚å¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ° ACKï¼ŒMAC å±‚ä¼šæ ¹æ® PIB ä¸­çš„ macMaxFrameRetries è®¾ç½®é‡è¯•æ¬¡æ•°ï¼Œç›´åˆ°æˆåŠŸæˆ–è¶…å‡ºæœ€å¤§é‡è¯•æ¬¡æ•°ã€‚ 2.5 å‘é€ç¡®è®¤ å¦‚æœæ•°æ®æˆåŠŸå‘é€ï¼ŒMAC å±‚ä¼šé€šè¿‡ MCPS-DATA.confirm å‘ä¸Šå±‚åº”ç”¨å‘é€æ•°æ®å‘é€æˆåŠŸçš„ç¡®è®¤ã€‚ å¦‚æœå‘é€å¤±è´¥ï¼ˆä¾‹å¦‚è¶…æ—¶æˆ–é‡è¯•æ¬¡æ•°ç”¨å°½ï¼‰ï¼ŒMAC å±‚ä¼šé€šçŸ¥ä¸Šå±‚å¤±è´¥åŸå› ã€‚ MAC constants &amp;&amp; PIBåœ¨ IEEE 802.15.4 æ ‡å‡†ä¸­ï¼ŒMACï¼ˆMedium Access Controlï¼‰å±‚ä½¿ç”¨ä¸€äº›å¸¸é‡å’Œ PIBï¼ˆProtocol Information Baseï¼‰å±æ€§æ¥æ§åˆ¶å’Œé…ç½®è®¾å¤‡çš„è¡Œä¸ºã€‚å¸¸é‡ç”¨äºè®¾ç½® MAC å±‚æ“ä½œçš„å‚æ•°èŒƒå›´ï¼Œè€Œ PIB å±æ€§åˆ™ä¿å­˜è®¾å¤‡çš„é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ MAC å¸¸é‡ å’Œ PIB å±æ€§ çš„è¯¦ç»†è¯´æ˜ã€‚ 1. MAC å¸¸é‡ 1.1 å¸¸é‡æ¦‚è¿°MAC å¸¸é‡æ˜¯é¢„å®šä¹‰çš„å¸¸é‡å€¼ï¼Œç”¨äºæŒ‡å®šåœ¨ MAC å±‚æ“ä½œä¸­ä½¿ç”¨çš„å„ç§å‚æ•°ã€‚ä¾‹å¦‚ï¼Œè¿™äº›å¸¸é‡ç”¨äºæ•°æ®ä¼ è¾“ã€é‡è¯•æ¬¡æ•°ã€æœ€å¤§å¸§å¤§å°ç­‰ã€‚å®ƒä»¬å®šä¹‰äº† MAC å±‚çš„ä¸€äº›è¡Œä¸ºè§„èŒƒã€‚ 1.2 å¸¸è§çš„ MAC å¸¸é‡ å¸¸é‡åç§° æè¿° MAC_MAX_FRAME_RETRIES æœ€å¤§å¸§é‡è¯•æ¬¡æ•°ã€‚æŒ‡å®šåœ¨å‘é€æ•°æ®æ—¶ï¼ŒMAC å±‚å…è®¸çš„æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚é»˜è®¤å€¼ä¸º 3ã€‚ MAC_ACK_WAIT_DURATION ç­‰å¾…ç¡®è®¤çš„æ—¶é—´ï¼ˆå•ä½ï¼šç¬¦å·æ—¶é—´ï¼‰ï¼ŒæŒ‡å®šäº†è®¾å¤‡åœ¨å‘é€æ•°æ®åï¼Œæœ€å¤šç­‰å¾…å¤šå°‘ç¬¦å·æ—¶é—´ä»¥æ¥æ”¶ ACKã€‚ MAC_MAX_FRAME_SIZE æœ€å¤§æ•°æ®å¸§å¤§å°ã€‚æŒ‡å®šäº†æ•°æ®å¸§çš„æœ€å¤§é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ MAC_PAN_ID PANï¼ˆPersonal Area Networkï¼‰IDï¼ŒæŒ‡å®šè®¾å¤‡æ‰€å±çš„ PAN æ ‡è¯†ç¬¦ã€‚ MAC_BROADCAST_ADDR å¹¿æ’­åœ°å€ã€‚é€šå¸¸ç”¨äºå¹¿æ’­æ•°æ®åŒ…ã€‚ MAC_SECURITY_ENABLED å®‰å…¨åŠŸèƒ½å¯ç”¨æ ‡å¿—ã€‚å¦‚æœä¸º trueï¼Œè¡¨ç¤ºå¯ç”¨å®‰å…¨åŠŸèƒ½ï¼ˆå¦‚åŠ å¯†å’Œè®¤è¯ï¼‰ã€‚ MAC_FRAME_TYPE_DATA æ•°æ®å¸§ç±»å‹å¸¸é‡ã€‚æŒ‡å®šè¯¥æ•°æ®å¸§æ˜¯æ•°æ®ä¼ è¾“å¸§ã€‚ MAC_FRAME_TYPE_ACK ç¡®è®¤å¸§ç±»å‹å¸¸é‡ã€‚æŒ‡å®šè¯¥æ•°æ®å¸§æ˜¯ ACK ç¡®è®¤å¸§ã€‚ 1.3 å¸¸é‡ç”¨é€”è¿™äº›å¸¸é‡å®šä¹‰äº†è®¾å¤‡çš„è¡Œä¸ºè§„èŒƒï¼Œä¾‹å¦‚ï¼š MAC_MAX_FRAME_RETRIES æ§åˆ¶æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œç¡®ä¿è®¾å¤‡ä¸ä¼šå› ä¸ºå¤šæ¬¡å‘é€å¤±è´¥è€Œè¿›å…¥æ— é™é‡è¯•çŠ¶æ€ã€‚ MAC_ACK_WAIT_DURATION ç¡®å®šäº†è®¾å¤‡åœ¨å‘é€æ•°æ®åç­‰å¾…ç¡®è®¤çš„æ—¶é—´ï¼Œè¿™å¯¹äºç½‘ç»œä¸­çš„æ•°æ®ä¼ è¾“å»¶è¿Ÿæ§åˆ¶è‡³å…³é‡è¦ã€‚ MAC_SECURITY_ENABLED åˆ™æ§åˆ¶è®¾å¤‡æ˜¯å¦ä½¿ç”¨åŠ å¯†å’Œè®¤è¯æœºåˆ¶ï¼Œæé«˜æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ã€‚ 2. PIB å±æ€§ 2.1 PIB æ¦‚è¿°PIBï¼ˆProtocol Information Baseï¼‰æ˜¯ä¸€ä¸ªå­˜å‚¨åè®®é…ç½®ä¿¡æ¯çš„æ•°æ®åº“ã€‚å®ƒä¿å­˜äº†ä¸ MAC å±‚çš„æ“ä½œç›¸å…³çš„å„ç§é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚PIB å±æ€§ç”¨äºé…ç½®è®¾å¤‡çš„ MAC å±‚è¡Œä¸ºï¼Œå¹¶åœ¨è®¾å¤‡è¿è¡Œæ—¶è¿›è¡Œä¿®æ”¹å’Œè¯»å–ã€‚ 2.2 å¸¸è§çš„ PIB å±æ€§ å±æ€§åç§° æè¿° macShortAddress è®¾å¤‡çš„çŸ­åœ°å€ï¼ˆ16 ä½ï¼‰ã€‚ç”¨äºæ ‡è¯†è®¾å¤‡åœ¨åŒä¸€ PAN å†…çš„å”¯ä¸€æ€§ã€‚ macExtendedAddress è®¾å¤‡çš„æ‰©å±•åœ°å€ï¼ˆ64 ä½ï¼‰ï¼Œåœ¨ PAN å†…å”¯ä¸€æ ‡è¯†è®¾å¤‡ã€‚ macPANId PAN çš„æ ‡è¯†ç¬¦ï¼Œè®¾å¤‡æ‰€å±çš„ä¸ªäººåŒºåŸŸç½‘ç»œçš„ IDã€‚ macBeaconOrder ä¿¡æ ‡å‘¨æœŸçš„å‘¨æœŸæ€§å‚æ•°ï¼ŒæŒ‡ç¤ºè®¾å¤‡å‘å°„ä¿¡æ ‡çš„é¢‘ç‡ã€‚ macSuperframeOrder è¶…å¸§é¡ºåºï¼Œå†³å®šè®¾å¤‡åœ¨ç½‘ç»œä¸­æ´»åŠ¨æ—¶ä½¿ç”¨çš„æ—¶é—´æ®µã€‚ macMaxFrameRetries æ•°æ®ä¼ è¾“å¤±è´¥åçš„æœ€å¤§é‡è¯•æ¬¡æ•°ã€‚ macMaxCSMABackoffs åœ¨å‘é€æ•°æ®ä¹‹å‰ï¼Œè®¾å¤‡å…è®¸çš„æœ€å¤§é€€é¿æ¬¡æ•°ï¼Œç”¨äºé¿å…ç¢°æ’ã€‚ macSecurityMode å®‰å…¨æ¨¡å¼ï¼ŒæŒ‡ç¤ºæ˜¯å¦å¯ç”¨åŠ å¯†å’Œè®¤è¯ã€‚ macRxOnWhenIdle è®¾å¤‡æ˜¯å¦åœ¨ç©ºé—²æ—¶ä¿æŒæ¥æ”¶æ¨¡å¼ã€‚å¦‚æœä¸º trueï¼Œè®¾å¤‡å³ä½¿åœ¨ç©ºé—²æ—¶ä¹Ÿèƒ½æ¥æ”¶æ•°æ®ã€‚ macMaxFrameSize å…è®¸çš„æœ€å¤§æ•°æ®å¸§å¤§å°ã€‚ macAckWaitDuration ç­‰å¾…ç¡®è®¤çš„æœ€å¤§æ—¶é—´ï¼ˆç¬¦å·æ—¶é—´å•ä½ï¼‰ã€‚ macTransactionPersistenceTime äº‹åŠ¡æŒä¹…åŒ–æ—¶é—´ï¼ŒæŒ‡ç¤ºåœ¨äº‹åŠ¡æœŸé—´å†…è®¾å¤‡å¯ä»¥ä¿æŒæ•°æ®ä¼ è¾“çŠ¶æ€ã€‚ 2.3 PIB å±æ€§ç”¨é€”PIB å±æ€§ç”¨äºæ§åˆ¶å’Œé…ç½®è®¾å¤‡åœ¨ MAC å±‚ ä¸Šçš„è¡Œä¸ºã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ PIB å±æ€§åŠå…¶åº”ç”¨ï¼š macShortAddress å’Œ macExtendedAddressï¼šç”¨äºè®¾å¤‡åœ°å€çš„æ ‡è¯†ã€‚çŸ­åœ°å€é€šå¸¸ç”¨äºå¿«é€Ÿæ•°æ®ä¼ è¾“ï¼Œè€Œæ‰©å±•åœ°å€ç”¨äºå…¨å±€å”¯ä¸€çš„æ ‡è¯†ã€‚ macPANIdï¼šç”¨äºæ ‡è¯†è®¾å¤‡æ‰€å±çš„ç½‘ç»œã€‚PAN ID æ˜¯è®¾å¤‡åŠ å…¥ç½‘ç»œçš„å…³é”®å‚æ•°ï¼Œç¡®ä¿è®¾å¤‡å¯ä»¥è¯†åˆ«ç½‘ç»œå¹¶ä¸å…¶ä»–è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚ macMaxFrameRetriesï¼šæ§åˆ¶é‡è¯•æ¬¡æ•°ï¼Œç¡®ä¿æ•°æ®çš„å¯é ä¼ è¾“ã€‚ macSecurityModeï¼šç¡®å®šæ˜¯å¦å¯ç”¨å®‰å…¨ç‰¹æ€§ï¼ˆå¦‚åŠ å¯†å’Œè®¤è¯ï¼‰ï¼Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚ macMaxCSMABackoffsï¼šæ§åˆ¶å‘é€å¤±è´¥åçš„é€€é¿æ¬¡æ•°ï¼Œç”¨äºå‡å°‘ç¢°æ’å¹¶æé«˜ä¼ è¾“æ•ˆç‡ã€‚ 2.4 PIB å’Œ MAC å¸¸é‡çš„å…³ç³»è®¸å¤š PIB å±æ€§ å®é™…ä¸Šæ˜¯ç”± MAC å¸¸é‡ å†³å®šçš„ã€‚ä¾‹å¦‚ï¼ŒmacMaxFrameRetries å’Œ MAC_MAX_FRAME_RETRIES å¸¸é‡æ˜¯ç›¸äº’å…³è”çš„ã€‚å¸¸é‡ç”¨äºè®¾ç½®é»˜è®¤å€¼ï¼Œè€Œ PIB å±æ€§ç”¨äºåœ¨è¿è¡Œæ—¶ä¿®æ”¹å’Œè¯»å–è®¾å¤‡çš„é…ç½®ã€‚ 3. PIB å±æ€§çš„è®¿é—®ä¸ä¿®æ”¹ 3.1 è¯»å–å’Œè®¾ç½® PIB å±æ€§è®¾å¤‡å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ¥å£æ¥è¯»å–å’Œä¿®æ”¹ PIB å±æ€§ã€‚ä¾‹å¦‚ï¼Œè®¾å¤‡å¯ä»¥é€šè¿‡ MLMEï¼ˆMAC Layer Management Entityï¼‰æ¥å£æ¥è®¾ç½®æˆ–è·å– PIB å±æ€§ã€‚ ç¤ºä¾‹ï¼šè®¾ç½® PIB å±æ€§ MLME_SET.request &#123; pibAttribute: macShortAddress, pibAttributeValue: 0x1234 &#125;","tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"}]},{"title":"hexo github.io image æ˜¾ç¤ºå¼‚å¸¸","date":"2025-03-25T23:53:42.000Z","path":"wiki/hexo-image-sync-my-solution/","text":"åœ¨ä½¿ç”¨ hexo å†™ blog æ’å…¥å›¾ç‰‡æ—¶ï¼Œå¤§å¤šæ•°ä¼šä½¿ç”¨ typora&#x2F;markdown allin one ç­‰å» previewï¼Œæ­¤æ—¶çš„(preview) img path æ˜¯ç›¸å¯¹ source&#x2F;_posts&#x2F;**.md æ–‡æ¡£çš„è·¯å¾„ï¼›è€Œ github.io é™æ€é¡µé¢å±•ç¤ºå›¾ç‰‡æ˜¯è¦ä½¿ç”¨public ä¸º root path çš„è·¯å¾„å¼•ç”¨å›¾ç‰‡ï¼›è·¯å¾„ä¸match ä¼šå¯¼è‡´å›¾ç‰‡æ˜¾ç¤ºå¼‚å¸¸ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šçš„æ¡ˆä¾‹å’Œè§£æ³•ï¼Œä½¿ç”¨èµ·æ¥æ„Ÿè§‰å§‹ç»ˆä¸é¡ºæ‰‹ï¼Œåœ¨è¿™é‡Œæ”¾ä¸Šæˆ‘çš„è§£æ³•ã€‚ 1.åˆ›å»ºå¦‚ä¸‹ç›®å½•ç»“æ„ï¼šblog/source/images , blog/public/images , blog/sync.py 2.ç¼–è¾‘ **.md å¹¶æƒ³è¦é¢„è§ˆæ—¶ï¼Œè¯·æ’å…¥ç±»ä¼¼ä¸‹é¢çš„å›¾ç‰‡é“¾æ¥ 1&lt;center&gt;&lt;img src=&quot;/../images/802-15-4-mac-frm/4_beacon_frm.png&quot; width=&quot;800px&quot;&gt;&lt;/center&gt; 3.å®Œæˆç¼–è¾‘ååœ¨ blog folder ä¸‹è¿è¡Œ python3 sync.py add sync, ä¼šå°† source/images ä¸‹ img sync åˆ° public/imgs, åŒæ—¶å°†æ‰€æœ‰ **.md ä¸­çš„å›¾ç‰‡é“¾æ¥å‰åŠ â€œ/â€è½¬ä¸ºå¦‚ä¸‹ï¼Œä½¿å¯ä»¥åœ¨github.ioä¸Šæ˜¾ç¤º 1&lt;center&gt;&lt;img src=&quot;/../images/802-15-4-mac-frm/4_beacon_frm.png&quot; width=&quot;800px&quot;&gt;&lt;/center&gt; 4.è¿è¡Œ python3 sync.py add sync å md preview å°†æ— æ³•æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡ï¼Œå¦‚æœæƒ³é‡æ–°ç¼–è¾‘å¯ä»¥å†è¿è¡Œ python3 sync.py remove å³å¯ 5.æˆ‘çš„ä¸Šblog step: python3 sync.py add sync -> hexo c -> hexo g -> hexo d **ä¸‹é¢é™„ä¸Šsync.pyçš„codeï¼Œè¿™ä¸ªæ˜¯è¯·æ•™chatgptå¸®å¿™å†™çš„** å‘½ä»¤ ä½œç”¨ python sync_and_modify.py sync ä»…åŒæ­¥ source/images åˆ° public/images python sync_and_modify.py add ä»…å¢åŠ  Markdown ä¸­ img src é‡Œçš„ / python sync_and_modify.py sync add åŒæ­¥å›¾ç‰‡ + å¢åŠ  / python sync_and_modify.py remove ä»…å»æ‰ Markdown ä¸­ img src é‡Œçš„ /ï¼ˆå•ç‹¬æ‰§è¡Œï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108import osimport shutilimport reimport sysdef sync_folders(src, dest): &quot;&quot;&quot; åŒæ­¥ source/images åˆ° public/imagesï¼Œç¡®ä¿æ–‡ä»¶å’Œç›®å½•ä¿æŒä¸€è‡´ã€‚ &quot;&quot;&quot; if not os.path.exists(src): print(f&quot;æºç›®å½• &#123;src&#125; ä¸å­˜åœ¨ï¼&quot;) return if not os.path.exists(dest): os.makedirs(dest) # å¦‚æœç›®æ ‡æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º for root, dirs, files in os.walk(src): rel_path = os.path.relpath(root, src) target_dir = os.path.join(dest, rel_path) if not os.path.exists(target_dir): os.makedirs(target_dir) for file in files: src_file = os.path.join(root, file) dest_file = os.path.join(target_dir, file) if not os.path.exists(dest_file) or os.path.getmtime(src_file) &gt; os.path.getmtime(dest_file): shutil.copy2(src_file, dest_file) print(f&quot;åŒæ­¥æ–‡ä»¶: &#123;src_file&#125; -&gt; &#123;dest_file&#125;&quot;) print(&quot;å›¾ç‰‡åŒæ­¥å®Œæˆï¼&quot;)def modify_image_paths_in_markdown(posts_folder, mode): &quot;&quot;&quot; éå† source/_posts ç›®å½•ä¸‹æ‰€æœ‰ .md æ–‡ä»¶ï¼Œä¿®æ”¹ img æ ‡ç­¾ä¸­çš„ src è·¯å¾„ã€‚ å‚æ•°: posts_folder: Markdown æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼ˆå¦‚ source/_postsï¼‰ mode: &quot;remove_slash&quot; -&gt; ç§»é™¤ img src é‡Œå¼€å¤´çš„ &quot;/&quot; &quot;add_slash&quot; -&gt; ç»™ img src é‡Œå¼€å¤´å¢åŠ  &quot;/&quot; &quot;&quot;&quot; if not os.path.exists(posts_folder): print(f&quot;Markdown ç›®å½• &#123;posts_folder&#125; ä¸å­˜åœ¨ï¼&quot;) return # æ­£åˆ™åŒ¹é… `&lt;img src=&quot;...&quot;` è¯­æ³• pattern_remove_slash = re.compile(r&#x27;(&lt;img src=&quot;)/(\\.\\./images/[^&quot;]+&quot;)&#x27;) pattern_add_slash = re.compile(r&#x27;(&lt;img src=&quot;)(\\.\\./images/[^&quot;]+&quot;)&#x27;) modified_files = 0 for filename in os.listdir(posts_folder): if filename.endswith(&quot;.md&quot;): file_path = os.path.join(posts_folder, filename) with open(file_path, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f: content = f.read() # æ ¹æ®æ¨¡å¼ä¿®æ”¹ if mode == &quot;remove_slash&quot;: new_content = pattern_remove_slash.sub(r&#x27;\\1\\2&#x27;, content) elif mode == &quot;add_slash&quot;: new_content = pattern_add_slash.sub(r&#x27;\\1/\\2&#x27;, content) else: print(f&quot;æœªçŸ¥æ¨¡å¼ï¼š&#123;mode&#125;&quot;) return # å¦‚æœå†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œåˆ™å†™å…¥æ–‡ä»¶ if content != new_content: with open(file_path, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f: f.write(new_content) print(f&quot;å·²ä¿®æ”¹æ–‡ä»¶: &#123;filename&#125;&quot;) modified_files += 1 print(f&quot;Markdown æ–‡ä»¶è·¯å¾„ä¿®æ”¹å®Œæˆï¼Œå…±ä¿®æ”¹ &#123;modified_files&#125; ä¸ªæ–‡ä»¶ï¼&quot;)def main(): # è®¾ç½®æ–‡ä»¶å¤¹è·¯å¾„ source_images = &quot;source/images&quot; public_images = &quot;public/images&quot; markdown_folder = &quot;source/_posts&quot; # è§£æå‘½ä»¤è¡Œå‚æ•° args = set(arg.lower() for arg in sys.argv[1:]) if not args: print(&quot;ç”¨æ³•: python sync_and_modify.py [sync] [add] | remove&quot;) sys.exit(1) if &quot;remove&quot; in args and len(args) &gt; 1: print(&quot;é”™è¯¯ï¼šremove åªèƒ½å•ç‹¬æ‰§è¡Œï¼Œä¸èƒ½ä¸ sync æˆ– add ç»„åˆï¼&quot;) sys.exit(1) if &quot;sync&quot; in args: sync_folders(source_images, public_images) if &quot;add&quot; in args: modify_image_paths_in_markdown(markdown_folder, mode=&quot;add_slash&quot;) if &quot;remove&quot; in args: modify_image_paths_in_markdown(markdown_folder, mode=&quot;remove_slash&quot;)if __name__ == &quot;__main__&quot;: main()","tags":[{"name":"hexo","slug":"hexo","permalink":"http://example.com/tags/hexo/"}],"categories":[{"name":"æŠ€æœ¯æ‚è°ˆ","slug":"æŠ€æœ¯æ‚è°ˆ","permalink":"http://example.com/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/"}]},{"title":"802.15.4-mac_frm-general_review","date":"2025-03-10T11:23:52.000Z","path":"wiki/802-15-4-mac-frm/","text":"ä¸»è¦ä»‹ç»äº† 802.15.4 mac layer pdu å½¢å¼ä¸å„ bit å«ä¹‰, åŠå„ field å†…å®¹ General MAC frame format frm control Bits 0â€“2 3 4â€“5 6 7 8 9 10â€“11 12â€“13 14â€“15 Field Frame Type Security Enabled Frame Pending AR PAN ID Compression Reserved Sequence Number Suppression IE Present Destination Addressing Mode Frame Version mac frm type b2 b1 b0 Description 0 0 0 Beacon 0 0 1 Data 0 1 0 Acknowledgment 0 1 1 MAC command 1 0 0 Reserved 1 0 1 Multipurpose 1 1 0 Fragment or Fraka 1 1 1 Extended Security Enabled å­—æ®µè§£æå­—æ®µåŠŸèƒ½Security Enabled å­—æ®µç”¨äºæŒ‡ç¤º MAC å­å±‚æ˜¯å¦å¯¹è¯¥å¸§è¿›è¡Œäº†å®‰å…¨ä¿æŠ¤ã€‚ Security Enabled å€¼ ä½œç”¨ 1 å¯ç”¨ MAC å±‚å®‰å…¨ä¿æŠ¤ï¼Œå¸§å¤´åŒ…å«Auxiliary Security Header 0 æœªå¯ç”¨å®‰å…¨ä¿æŠ¤ï¼Œå¸§å¤´ä¸åŒ…å«Auxiliary Security Header Frame Pending å­—æ®µè§£æå­—æ®µåŠŸèƒ½Frame Pending å­—æ®µç”¨äºæŒ‡ç¤ºå‘é€è®¾å¤‡æ˜¯å¦æœ‰æ›´å¤šæ•°æ®ç­‰å¾…å‘é€ç»™æ¥æ”¶è®¾å¤‡ã€‚ Frame Pending å€¼ ä½œç”¨ 1 å‘é€è®¾å¤‡ä»æœ‰å¾…å‘é€çš„æ•°æ®ï¼Œæ¥æ”¶è®¾å¤‡åº”ç»§ç»­ç›‘å¬ 0 å‘é€è®¾å¤‡æ— å¾…å‘é€æ•°æ®ï¼Œæ¥æ”¶è®¾å¤‡å¯è¿›å…¥ä½åŠŸè€—æ¨¡å¼ é€‚ç”¨åœºæ™¯ä¿¡æ ‡å¸§ï¼ˆBeacon Frameï¼‰ ä»…åœ¨ä¿¡æ ‡å¸§ï¼ˆBeacon Frameï¼‰æˆ–åœ¨ ä¿¡æ ‡ä½¿èƒ½ PANï¼ˆbeacon-enabled PANï¼‰å†…çš„ CAP æ—¶æ®µ å‘é€çš„æ•°æ®å¸§ä¸­ä½¿ç”¨ã€‚ åœ¨ éä¿¡æ ‡ä½¿èƒ½ PANï¼ˆnonbeacon-enabled PANï¼‰ä¸­ï¼Œå¯åœ¨ä»»æ„æ—¶é—´ä½¿ç”¨è¯¥å­—æ®µã€‚ ä½èƒ½è€—ï¼ˆLEï¼‰CSL æ¨¡å¼ è‹¥ Frame Pending = 1ï¼Œè¡¨ç¤ºå‘é€è®¾å¤‡ä»æœ‰æ•°æ®ï¼Œå¹¶æœŸæœ›æ¥æ”¶è®¾å¤‡ä¿æŒå°„é¢‘ï¼ˆRFï¼‰å¼€å¯ï¼Œç›´åˆ° Frame Pending å˜ä¸º 0ã€‚ TSCH æ¨¡å¼ è‹¥ Frame Pending = 1ï¼Œè¡¨ç¤ºæ¥æ”¶è®¾å¤‡åœ¨ ä¸‹ä¸€æ—¶éš™ï¼ˆtimeslotï¼‰ ä»éœ€ä¿æŒåœ¨çº¿ï¼Œå¹¶åœ¨ç›¸åŒä¿¡é“ç­‰å¾…æ•°æ®ï¼ˆè‹¥å½“å‰æ— è°ƒåº¦çš„é“¾è·¯ï¼‰ã€‚ å…¶ä»–æƒ…å†µ é™¤ä¸Šè¿°æƒ…å†µå¤–ï¼ŒFrame Pending å­—æ®µåœ¨ å‘é€æ—¶åº”å§‹ç»ˆè®¾ä¸º 0ï¼Œæ¥æ”¶æ—¶åº”å¿½ç•¥è¯¥å­—æ®µã€‚ AR å­—æ®µè§£æå­—æ®µåŠŸèƒ½ARï¼ˆAcknowledgment Requestï¼Œç¡®è®¤è¯·æ±‚ï¼‰å­—æ®µç”¨äºæŒ‡å®šæ¥æ”¶è®¾å¤‡åœ¨æ”¶åˆ°æ•°æ®å¸§ï¼ˆData Frameï¼‰æˆ– MAC å‘½ä»¤å¸§ï¼ˆMAC Command Frameï¼‰åï¼Œæ˜¯å¦éœ€è¦å‘é€ç¡®è®¤å¸§ï¼ˆAck Frameï¼‰ã€‚ å­—æ®µè§„åˆ™ AR å€¼ æ˜¯å¦éœ€è¦ Ack é€‚ç”¨åœºæ™¯ 1 éœ€è¦ å…³é”®æ•°æ®ï¼ŒMAC å‘½ä»¤ï¼Œå¯é ä¼ è¾“ 0 ä¸éœ€è¦ å¹¿æ’­å¸§ï¼Œéå…³é”®æ•°æ®ï¼Œä½åŠŸè€—åœºæ™¯ AR å­—æ®µçš„å½±å“æé«˜ä¼ è¾“å¯é æ€§å¯ç”¨ ARï¼Œå‘é€è®¾å¤‡å¯ä»¥ç¡®ä¿æ•°æ®æˆåŠŸåˆ°è¾¾ï¼Œå¦åˆ™ä¼šè¿›è¡Œé‡ä¼ ï¼ˆå¦‚æœæ”¯æŒï¼‰ã€‚ é™ä½èƒ½è€—å…³é—­ AR å¯ä»¥å‡å°‘é¢å¤–çš„ Ack ä¼ è¾“ï¼Œä»è€Œé™ä½è®¾å¤‡åŠŸè€—ï¼Œé€‚ç”¨äºä½åŠŸè€— IoT è®¾å¤‡ã€‚ ä¼˜åŒ–ä¿¡é“å ç”¨åœ¨é«˜æµé‡ç½‘ç»œä¸­ï¼Œé¿å…ä¸å¿…è¦çš„ Ackï¼Œå¯ä»¥å‡å°‘ä¿¡é“ç«äº‰ï¼Œæé«˜æ•´ä½“é€šä¿¡æ•ˆç‡ã€‚ PAN ID Compression å­—æ®µè§£æå­—æ®µä½œç”¨PAN ID Compression å­—æ®µç”¨äºæŒ‡ç¤º PAN IDï¼ˆä¸ªäººåŒºåŸŸç½‘ç»œæ ‡è¯†ï¼‰ æ˜¯å¦åŒ…å«åœ¨ MAC å¸§ä¸­ï¼Œä»¥å‡å°‘æ•°æ®å¼€é”€ã€‚ è§£æè§„åˆ™ å½“ å¸§ç‰ˆæœ¬ï¼ˆFrame Versionï¼‰å­—æ®µå€¼ ä¸º 0b00 æˆ– 0b01 æ—¶ï¼š åŒæ—¶åŒ…å«ç›®æ ‡åœ°å€å’Œæºåœ°å€æ—¶ï¼š è‹¥ ç›®æ ‡ PAN ID ä¸æº PAN ID ç›¸åŒï¼Œåˆ™ PAN ID Compression è®¾ä¸º 1ï¼Œçœç•¥ Source PAN ID å­—æ®µã€‚ è‹¥ ç›®æ ‡ PAN ID ä¸æº PAN ID ä¸åŒï¼Œåˆ™ PAN ID Compression è®¾ä¸º 0ï¼ŒåŒæ—¶åŒ…å« Destination PAN ID å’Œ Source PAN ID å­—æ®µã€‚ ä»…åŒ…å«ç›®æ ‡åœ°å€æˆ–æºåœ°å€æ—¶ï¼š PAN ID Compression è®¾ä¸º 0ï¼Œå¹¶ä¸”è¯¥åœ°å€çš„ PAN ID å­—æ®µå¿…é¡»åŒ…å«åœ¨ MAC å¸§ä¸­ã€‚ å½“ å¸§ç‰ˆæœ¬å­—æ®µå€¼ ä¸º 0b10 æ—¶ï¼š PAN ID Compression å­—æ®µçš„å…·ä½“è®¾ç½®å–å†³äº ä¿¡æ ‡å¸§ï¼ˆBeacon Frameï¼‰ã€æ•°æ®å¸§ï¼ˆData Frameï¼‰ã€MAC å‘½ä»¤å¸§ï¼ˆMAC Command Frameï¼‰å’Œç¡®è®¤å¸§ï¼ˆAck Frameï¼‰ çš„åœ°å€æ ¼å¼ï¼Œå¹¶éµå¾ª è¡¨ 7-2 è§„å®šçš„ç»„åˆæ–¹å¼ã€‚ ä»»ä½•ä¸ç¬¦åˆ è¡¨ 7-2 è§„å®šçš„ç»„åˆæ–¹å¼ä¸åº”ç”Ÿæˆã€‚ Destination Address Source Address Destination PAN ID Source PAN ID PAN ID Compression Not Present Not Present Not Present Not Present 0 Not Present Not Present Present Not Present 1 Present Not Present Present Not Present 0 Present Not Present Not Present Not Present 1 Not Present Present Not Present Present 0 Not Present Present Not Present Not Present 1 Extended Extended Present Not Present 0 Extended Extended Not Present Not Present 1 Shorta Shorta Present Present 0 Shorta Extended Present Present 0 Extended Shorta Present Present 0 Shorta Extended Present Not Present 1 Extended Shorta Present Not Present 1 Shorta Shorta Present Not Present 1 æ€»ç»“ PAN ID Compression å€¼ å«ä¹‰ 1 ç›®æ ‡ PAN ID ä¸æº PAN ID ç›¸åŒï¼Œçœç•¥ Source PAN ID 0 ç›®æ ‡ PAN ID ä¸æº PAN ID ä¸åŒï¼Œéœ€åŒ…å« Destination PAN ID å’Œ Source PAN ID è¯¥å­—æ®µçš„ä½¿ç”¨å¯ä»¥æœ‰æ•ˆå‡å°‘ MAC å¸§é•¿åº¦ï¼Œä¼˜åŒ–ç½‘ç»œé€šä¿¡æ•ˆç‡ã€‚ğŸ“¡ Sequence Number Suppression å­—æ®µå­—æ®µä½œç”¨Sequence Number Suppression å­—æ®µç”¨äºæŒ‡ç¤ºæ˜¯å¦å‹åˆ¶å¸§ä¸­çš„ Sequence Numberï¼ˆåºåˆ—å·ï¼‰ å­—æ®µã€‚ Sequence Number Suppression å€¼ å«ä¹‰ 1 åºåˆ—å·å­—æ®µè¢«å‹åˆ¶ï¼Œçœç•¥åºåˆ—å· 0 åºåˆ—å·å­—æ®µå­˜åœ¨ ç‰¹æ®Šæƒ…å†µï¼š å¦‚æœ Frame Versionï¼ˆå¸§ç‰ˆæœ¬ï¼‰å­—æ®µ çš„å€¼ä¸º 0b00 æˆ– 0b01ï¼Œåˆ™ Sequence Number Suppression å­—æ®µå¿…é¡»ä¸º 0ï¼Œå³ åºåˆ—å·å­—æ®µå¿…é¡»å­˜åœ¨ã€‚ IE Present å­—æ®µå­—æ®µä½œç”¨IE Present å­—æ®µç”¨äºæŒ‡ç¤ºå¸§ä¸­æ˜¯å¦åŒ…å« Information Elements (IEs)ã€‚ IE Present å€¼ å«ä¹‰ 1 å¸§ä¸­åŒ…å« IEs 0 å¸§ä¸­ä¸åŒ…å« IEs ç‰¹æ®Šæƒ…å†µï¼š å¦‚æœ Frame Versionï¼ˆå¸§ç‰ˆæœ¬ï¼‰å­—æ®µ çš„å€¼ä¸º 0b00 æˆ– 0b01ï¼Œåˆ™ IE Present å­—æ®µå¿…é¡»ä¸º 0ï¼Œå³å¸§ä¸­ä¸åŒ…å« IEsã€‚ æ­¤å­—æ®µçš„è®¾ç½®å¯¹äºç¡®å®šå¸§çš„å†…å®¹å’Œå¤„ç†æ–¹å¼éå¸¸é‡è¦ã€‚ğŸ“¦ Destination Addressing Mode å­—æ®µå­—æ®µä½œç”¨Destination Addressing Mode å­—æ®µç”¨äºæŒ‡å®šå¸§çš„ç›®æ ‡åœ°å€æ¨¡å¼ã€‚æ­¤å­—æ®µçš„å€¼å¯ä»¥æ ¹æ®ä¸åŒçš„å¸§ç±»å‹å’Œç‰ˆæœ¬æ¥å†³å®šå¸§çš„åœ°å€æ ¼å¼ã€‚ è§£æè§„åˆ™ Destination Addressing Mode å­—æ®µåº”è®¾ç½®ä¸º Table 7-3 ä¸­åˆ—å‡ºçš„å€¼ä¹‹ä¸€ã€‚ å¦‚æœ Destination Addressing Mode å­—æ®µçš„å€¼ä¸º 0 ä¸” Frame Typeï¼ˆå¸§ç±»å‹ï¼‰å­—æ®µ æŒ‡å®šä¸º Data frame æˆ– MAC command ä¸” Frame Versionï¼ˆå¸§ç‰ˆæœ¬ï¼‰å­—æ®µ ä¸º 0b00 æˆ– 0b01ï¼š Source Addressing Modeï¼ˆæºåœ°å€æ¨¡å¼ï¼‰å­—æ®µ å¿…é¡»ä¸ºéé›¶å€¼ï¼Œè¡¨ç¤ºå¸§æ˜¯å‘é€ç»™ PAN coordinatorï¼Œå¹¶ä¸”å¸§ä¸­çš„ Source PAN ID å­—æ®µæŒ‡å®šäº† PAN IDã€‚ å¯¹äºå¸§ç‰ˆæœ¬ä¸º 0b10 çš„æƒ…å†µï¼š Destination Address æˆ– Destination PAN ID æˆ–ä¸¤è€…å¯èƒ½ä¼šè¢«çœç•¥ã€‚ b1 b0 Description 0 0 PAN ID and address fields are not present. 0 1 Reserved 1 0 Address field contains a short address (16 bit). 1 1 Address field contains an extended address (64 bit). æ€»ç»“ Destination Addressing Mode å€¼ å«ä¹‰ 0 æŒ‡å®šæºåœ°å€ä¿¡æ¯ï¼Œå¹¶ä¸”å¸§æ˜¯å‘é€ç»™ PAN åè°ƒå™¨ã€‚ å…¶ä»–å€¼ ç”± Table 7-3 å®šä¹‰ï¼Œå†³å®šç›®æ ‡åœ°å€æ¨¡å¼ã€‚ æ­¤å­—æ®µå®šä¹‰äº†å¦‚ä½•åœ¨æ•°æ®å¸§ä¸­è¡¨ç¤ºç›®æ ‡åœ°å€ï¼Œå½±å“å¸§çš„ä¼ è¾“å’Œå¤„ç†ã€‚ğŸ“¡ Frame Version å­—æ®µå­—æ®µä½œç”¨Frame Version å­—æ®µæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œç”¨äºæŒ‡å®šä¸å¸§å¯¹åº”çš„ç‰ˆæœ¬å·ã€‚æ‰€æœ‰å¸§ç±»å‹éƒ½åº”æŒ‰ç…§å„è‡ªå­æ¡æ¬¾ä¸­æè¿°çš„æ–¹å¼è®¾ç½® Frame Version å­—æ®µã€‚ ç‰ˆæœ¬æ€»ç»“ Frame Version å­—æ®µå†³å®šäº†å¸§çš„ç‰ˆæœ¬å·ã€‚ æ¯ç§å¸§ç±»å‹æœ‰ä¸åŒçš„ç‰ˆæœ¬å·è¦æ±‚ï¼Œè¿™äº›è¦æ±‚åœ¨ Table 7-4 ä¸­è¿›è¡Œäº†æ€»ç»“ã€‚ ç‰ˆæœ¬é€‚ç”¨æ€§æ¯ä¸ªå¸§ç±»å‹çš„é€‚ç”¨ç‰ˆæœ¬æ€»ç»“å¦‚ä¸‹ï¼š Frame Version é€‚ç”¨çš„å¸§ç±»å‹ 0b00 é€‚ç”¨äºç‰¹å®šå¸§ç±»å‹ï¼Œå…·ä½“è¯·å‚è€ƒ Table 7-4 0b01 é€‚ç”¨äºç‰¹å®šå¸§ç±»å‹ï¼Œå…·ä½“è¯·å‚è€ƒ Table 7-4 0b10 é€‚ç”¨äºç‰¹å®šå¸§ç±»å‹ï¼Œå…·ä½“è¯·å‚è€ƒ Table 7-4 Frame Type Frame Version 0b00 Frame Version 0b01 Frame Version 0b10 Frame Version 0b11 Beacon IEEE Std 802.15.4-2003 IEEE Std 802.15.4-2006 IEEE Std 802.15.4 Reserved Data IEEE Std 802.15.4-2003 IEEE Std 802.15.4-2006 IEEE Std 802.15.4 Reserved Acknowledgment IEEE Std 802.15.4-2003 IEEE Std 802.15.4-2006 IEEE Std 802.15.4 Reserved MAC Command IEEE Std 802.15.4-2003 IEEE Std 802.15.4-2006 IEEE Std 802.15.4 Reserved Reserved â€” â€” â€” â€” Multipurpose IEEE Std 802.15.4 Reserved Reserved Reserved Fragment Frame Version field not present in frame Frame Version field not present in frame Frame Version field not present in frame Frame Version field not present in frame Extended Frame Version field not present in frame Frame Version field not present in frame Frame Version field not present in frame Frame Version field not present in frame Source Addressing Mode field Source Addressing Mode å­—æ®µçš„å€¼åº”è®¾ç½®ä¸º Table 7-3 ä¸­åˆ—å‡ºçš„å€¼ä¹‹ä¸€ã€‚ å½“è¯¥å­—æ®µä¸º 0 ä¸” Frame Type å­—æ®µæŒ‡å®šä¸º Data frame æˆ– MAC commandï¼Œå¹¶ä¸” Frame Version å­—æ®µä¸º 0b00 æˆ– 0b01ï¼Œåˆ™ Destination Addressing Mode å­—æ®µå¿…é¡»ä¸ºéé›¶ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œæ„å‘³ç€è¯¥å¸§æºè‡ª PAN coordinatorï¼Œå…¶ PAN ID ç”± Destination PAN ID å­—æ®µæŒ‡å®šã€‚ Sequence Number field Sequence Number å­—æ®µç”¨äºæŒ‡å®šè¯¥å¸§çš„åºåˆ—æ ‡è¯†ç¬¦ã€‚ å¯¹äº Beacon frameï¼Œè¯¥å­—æ®µæŒ‡å®š BSN (Beacon Sequence Number)ã€‚ å¯¹äºå…¶ä»–å¸§ï¼Œè¯¥å­—æ®µæŒ‡å®š DSN (Data Sequence Number)ã€‚ Destination PAN ID field Destination PAN ID å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼ŒæŒ‡å®šç›®æ ‡è®¾å¤‡æ‰€åœ¨çš„ PAN IDã€‚ å¦‚æœè¯¥å­—æ®µçš„å€¼ä¸º å¹¿æ’­ PAN IDï¼ˆå®šä¹‰è§ 6.1ï¼‰ï¼Œåˆ™æ‰€æœ‰å½“å‰ç›‘å¬è¯¥ä¿¡é“çš„è®¾å¤‡éƒ½å°†å…¶è§†ä¸ºæœ‰æ•ˆ PAN IDã€‚ Destination Address field Destination Address å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰ç”¨äºæŒ‡å®šå¸§çš„æ¥æ”¶è€…åœ°å€ã€‚ å…¶é•¿åº¦ç”± Frame Control å­—æ®µçš„ Destination Addressing Modeï¼ˆè§ 7.2.1.8ï¼‰å†³å®šã€‚ å¦‚æœè¯¥å­—æ®µçš„å€¼ä¸º å¹¿æ’­çŸ­åœ°å€ï¼ˆå®šä¹‰è§ 6.1ï¼‰ï¼Œåˆ™æ‰€æœ‰å½“å‰ç›‘å¬è¯¥ä¿¡é“çš„è®¾å¤‡éƒ½å°†å…¶è§†ä¸ºæœ‰æ•ˆåœ°å€ã€‚ è¯¥å­—æ®µä»…åœ¨ Destination Addressing Mode å­—æ®µéé›¶æ—¶æ‰åŒ…å«åœ¨ MAC å¸§ä¸­ã€‚ Source PAN ID field Source PAN ID å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰ç”¨äºæŒ‡å®šè¯¥å¸§çš„å‘é€è€…æ‰€å±äºçš„ PAN IDã€‚ è®¾å¤‡çš„ PAN ID åˆå§‹ç”±å…¶åŠ å…¥ PAN æ—¶å†³å®šï¼Œä½†å¯èƒ½ä¼šå›  PAN ID å†²çªè§£å†³ï¼ˆè§ 6.3.2ï¼‰è€Œå‘ç”Ÿå˜åŒ–ã€‚ Source Address field Source Address å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰ç”¨äºæŒ‡å®šè¯¥å¸§çš„å‘é€è€…åœ°å€ã€‚ è¯¥å­—æ®µä»…åœ¨ Source Addressing Mode å­—æ®µéé›¶æ—¶æ‰åŒ…å«åœ¨ MAC å¸§ ä¸­ã€‚ Auxiliary Security Header field Auxiliary Security Header å­—æ®µåŒ…å«ç”¨äº å®‰å…¨å¤„ç† æ‰€éœ€çš„ä¿¡æ¯ã€‚ è¯¥å­—æ®µä»…åœ¨ Security Enabled å­—æ®µè®¾ä¸º 1 æ—¶æ‰ä¼šå­˜åœ¨ã€‚ Auxiliary Security Header å­—æ®µçš„æ ¼å¼è¯¦è§ 9.4ã€‚ IE Field IEï¼ˆInformation Elementï¼‰å­—æ®µ ä¸ºå¯å˜é•¿åº¦ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª IEã€‚ ç”± Header IE å’Œ Payload IE å­å­—æ®µç»„æˆã€‚ è¯¥å­—æ®µä»…åœ¨ Frame Control å­—æ®µä¸­çš„ IE Present è®¾ä¸º 1 æ—¶æ‰ä¼šå­˜åœ¨ã€‚ æ¯ä¸ª IE ç”± æè¿°ç¬¦ï¼ˆdescriptorï¼‰ å’Œ å¯é€‰è´Ÿè½½ï¼ˆoptional payloadï¼‰ ç»„æˆï¼Œå…·ä½“æè¿°è§ 7.4ã€‚ Header IE Header IEï¼ˆå¦‚æœå­˜åœ¨ï¼‰ä½äº Auxiliary Security Header ä¹‹åï¼Œå±äº MHRï¼ˆMAC Headerï¼‰ã€‚ Payload IE Payload IEï¼ˆå¦‚æœå­˜åœ¨ï¼‰ä½äº MHR ä¹‹åï¼Œå±äº MAC payloadï¼Œå³ Payload IE å¯èƒ½è¢«åŠ å¯†ã€‚ Octets Variable â€¦ Variable 0&#x2F;2 Variable â€¦ Variable 0&#x2F;2 Field Header IE #1 â€¦ Header IE #n Header Termination IE Payload IE #1 â€¦ Payload IE #m Payload Termination IE 7.2.9 Frame Payload Field Frame Payload å­—æ®µ åŒ…å«ç‰¹å®šäºå„å¸§ç±»å‹çš„ä¿¡æ¯ã€‚ å¦‚æœ Security Enabled å­—æ®µè®¾ä¸º 1ï¼Œåˆ™ Frame Payload å¯èƒ½å—åˆ° åŠ å¯†ä¿æŠ¤ï¼Œè¯¦è§ Clause 9ã€‚ 7.2.10 FCS Field FCSï¼ˆFrame Check Sequenceï¼‰å­—æ®µ åŒ…å«ä¸€ä¸ª 16-bit ITU-T CRC æˆ– 32-bit CRCï¼ˆç¬¦åˆ ANSI X3.66-1979.13ï¼‰ã€‚ FCS è®¡ç®—èŒƒå›´ åŒ…æ‹¬ MHR å’Œ MAC Payloadï¼Œç»Ÿç§°ä¸º è®¡ç®—å­—æ®µï¼ˆCalculation Fieldï¼‰ã€‚ å…¼å®¹ SUN PHYs æˆ– TVWS PHYs çš„è®¾å¤‡å¿…é¡»å®ç° 4-octet FCSã€‚ 7.4.1 IE List Terminationè¯´æ˜ åœ¨ç¡®å®š Header IEs æˆ– Payload IEs æ˜¯å¦éœ€è¦ç»ˆæ­¢æ—¶ï¼Œä¸è€ƒè™‘ è®¤è¯æˆ–åŠ å¯†è¿‡ç¨‹ã€‚ ä¸‹é¢çš„table è§„å®šäº† terminate IE ï¼š HT1ï¼ˆHeader Termination 1 IEï¼‰ï¼Œå®šä¹‰è§ 7.4.2.17ã€‚ HT2ï¼ˆHeader Termination 2 IEï¼‰ï¼Œå®šä¹‰è§ 7.4.2.18ã€‚ æ³¨æ„äº‹é¡¹ Header Termination IE å¿…é¡»å‡ºç°åœ¨ Payload IEs ä¹‹å‰ï¼Œå› ä¸º Header IEs å’Œ Payload IEs å…±äº«åœ°å€ç©ºé—´ï¼Œæ— æ³•ç›´æ¥åŒºåˆ†äºŒè€…çš„è¾¹ç•Œã€‚å› æ­¤ï¼Œéœ€è¦ä½¿ç”¨ Header Termination IE æ¥æ ‡è¯† Header IEs çš„ç»“æŸ å’Œ Payload IEs çš„å¼€å§‹ã€‚ Header IEs Present Payload IEs Present Data Payload Present Header Termination IE Included Payload Termination IE Included Notes No No No None None No IE lists present, hence no termination. Included here for completeness. Yes No No None None No termination is required because the end of the frame can be determined from the frame length and FCS length. No Yes No HT1 required Optional Header Termination IE 1 is required to signal end of the MHR and beginning of the Payload IE list. Yes Yes No HT1 required Optional Header Termination IE 1 is required while the Payload IE Termination is not required, but is allowed. No No Yes None None No IE lists present, hence no termination. Included here for completeness. Yes No Yes HT2 required None Header Termination IE 2 is used to signal end of the MHR and beginning of the MAC Payload. No Yes Yes HT1 required Required â€” Yes Yes Yes HT1 required Required â€” header ieHT1 &#x2F; HT2 ie ä¹Ÿä½¿ç”¨äº†ä¸‹è¡¨çš„æ ¼å¼ï¼Œåªä¸è¿‡ content len &#x3D; 0, ElementID &#x3D; 0x7E&#x2F;7F; Element ID çš„ä½¿ç”¨ï¼Œç›´æ¥å°±ä»£è¡¨äº†å…·ä½“çš„ header ie, è€Œ payload IE ä¸­çš„ Group ID åˆ™ä»£è¡¨äº†æ›´å¤šæ— é™çš„å¯èƒ½ ï½ Group ä¸‹è¿˜æœ‰ Nest IE ï½ sub-ID Bits 0â€“6 7â€“14 15 0â€“127 Field Length Element ID Type &#x3D; 0 Content payload ie Bits 0â€“10 11â€“14 15 0â€“2047 Field Length Group ID Type &#x3D; 1 Content nested short&#x2F;long ie ~ payload ie ~ group Id &#x3D; mlme(0x1)nested ie ä¸‹åˆåˆ†å‡ºäº†å¾ˆå¤š sub id ie Bits 0â€“7 8â€“14 15 0â€“255 Field Length Sub-ID Type &#x3D; 0 Content Bits 0â€“10 11â€“14 15 0â€“2047 Field Length Sub-ID Type &#x3D; 0 Content ä¸»è¦ä»‹ç»äº† 802.15.4 å…·ä½“çš„ frm type å¯¹åº”çš„ mac frm formats beacon frm data frm ack frm mac cmd frm multipurpose frm ext frm","tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"}]},{"title":"802.15.4-sec_related","date":"2025-03-08T02:54:19.000Z","path":"wiki/802-15-4-sec-related/","text":"ä»¥ drawio æµç¨‹å›¾çš„å½¢å¼ä»‹ç»äº† 802.15.4(2015) mac layer çš„åŠ è§£å¯†ï¼Œä¸»è¦æœ‰ï¼šincoming frm dec, outcoming frm enc, secure related PIBsã€‚ æ³¨ï¼š802.15.4 2015&#x2F;2006&#x2F;2003 ç‰ˆæœ¬åŠ è§£å¯†flowä¸Šå­˜åœ¨å·®å¼‚,ç‚¹å‡»æµç¨‹å›¾å¯ä»¥å…¨å±å±•å¼€ outgoing frm - enc incoming frm - sec on - dec incoming frm - sec on - dec sec pib related","tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"}]}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"},{"name":"æŠ€æœ¯æ‚è°ˆ","slug":"æŠ€æœ¯æ‚è°ˆ","permalink":"http://example.com/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/"}],"tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"},{"name":"hexo","slug":"hexo","permalink":"http://example.com/tags/hexo/"}]}