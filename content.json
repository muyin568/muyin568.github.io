{"pages":[{"title":"About","date":"2025-03-11T14:11:10.173Z","path":"about/index.html","text":""},{"title":"categories","date":"2025-03-12T00:21:03.000Z","path":"categories/index.html","text":""},{"title":"Tags","date":"2025-03-12T23:44:41.796Z","path":"tags/index.html","text":""}],"posts":[{"title":"802.15.4-mac_frm","date":"2025-03-10T11:23:52.000Z","path":"wiki/802-15-4-mac-frm/","text":"主要介绍了 802.15.4 mac layer pdu 形式与各 bit 含义 General MAC frame format frm control Bits 0–2 3 4–5 6 7 8 9 10–11 12–13 14–15 Field Frame Type Security Enabled Frame Pending AR PAN ID Compression Reserved Sequence Number Suppression IE Present Destination Addressing Mode Frame Version mac frm type b2 b1 b0 Description 0 0 0 Beacon 0 0 1 Data 0 1 0 Acknowledgment 0 1 1 MAC command 1 0 0 Reserved 1 0 1 Multipurpose 1 1 0 Fragment or Fraka 1 1 1 Extended Security EnabledSecurity Enabled 字段解析字段功能Security Enabled 字段用于指示 MAC 子层是否对该帧进行了安全保护。 若 Security Enabled = 1，表示该帧已启用安全保护。MAC 帧头（MHR）中必须包含 Auxiliary Security Header。 若 Security Enabled = 0，表示该帧未启用安全保护。MAC 帧头中不包含辅助安全头。 总结 Security Enabled 值 作用 1 启用 MAC 层安全保护，帧头包含辅助安全头 0 未启用安全保护，帧头不包含辅助安全头 --- Frame Pending 字段解析字段功能Frame Pending 字段用于指示发送设备是否有更多数据等待发送给接收设备。 若 Frame Pending = 1，表示发送设备仍有数据待发送。 若 Frame Pending = 0，表示当前无待发送数据。 适用场景信标帧（Beacon Frame） 仅在信标帧（Beacon Frame）或在 信标使能 PAN（beacon-enabled PAN）内的 CAP 时段 发送的数据帧中使用。 在 非信标使能 PAN（nonbeacon-enabled PAN）中，可在任意时间使用该字段。 低能耗（LE）CSL 模式 若 Frame Pending = 1，表示发送设备仍有数据，并期望接收设备保持射频（RF）开启，直到 Frame Pending 变为 0。 TSCH 模式 若 Frame Pending = 1，表示接收设备在 下一时隙（timeslot） 仍需保持在线，并在相同信道等待数据（若当前无调度的链路）。 其他情况 除上述情况外，Frame Pending 字段在 发送时应始终设为 0，接收时应忽略该字段。 总结 Frame Pending 值 作用 1 发送设备仍有待发送的数据，接收设备应继续监听 0 发送设备无待发送数据，接收设备可进入低功耗模式 --- AR 字段解析字段功能AR（Acknowledgment Request，确认请求）字段用于指定接收设备在收到数据帧（Data Frame）或 MAC 命令帧（MAC Command Frame）后，是否需要发送确认帧（Ack Frame）。 字段规则AR &#x3D; 1（需要确认） 接收设备在成功接收帧后，必须发送 Ack 确认帧，前提是该帧通过了帧过滤（参考 6.7.2 章节）。 适用于可靠传输场景，例如关键控制指令（如 MAC 命令帧）或需要保证数据完整传输的数据帧。 AR &#x3D; 0（不需要确认） 接收设备不会发送 Ack 确认帧。 适用于无需可靠传输的情况，例如广播帧（Broadcast Frame）或对数据丢失不敏感的应用场景。 AR 字段的影响提高传输可靠性启用 AR，发送设备可以确保数据成功到达，否则会进行重传（如果支持）。 降低能耗关闭 AR 可以减少额外的 Ack 传输，从而降低设备功耗，适用于低功耗 IoT 设备。 优化信道占用在高流量网络中，避免不必要的 Ack，可以减少信道竞争，提高整体通信效率。 总结 AR 值 是否需要 Ack 适用场景 1 需要 关键数据，MAC 命令，可靠传输 0 不需要 广播帧，非关键数据，低功耗场景 --- PAN ID Compression 字段解析字段作用PAN ID Compression 字段用于指示 PAN ID（个人区域网络标识） 是否包含在 MAC 帧中，以减少数据开销。 解析规则 当 帧版本（Frame Version）字段值 为 0b00 或 0b01 时： 同时包含目标地址和源地址时： 若 目标 PAN ID 与源 PAN ID 相同，则 PAN ID Compression 设为 1，省略 Source PAN ID 字段。 若 目标 PAN ID 与源 PAN ID 不同，则 PAN ID Compression 设为 0，同时包含 Destination PAN ID 和 Source PAN ID 字段。 仅包含目标地址或源地址时： PAN ID Compression 设为 0，并且该地址的 PAN ID 字段必须包含在 MAC 帧中。 当 帧版本字段值 为 0b10 时： PAN ID Compression 字段的具体设置取决于 信标帧（Beacon Frame）、数据帧（Data Frame）、MAC 命令帧（MAC Command Frame）和确认帧（Ack Frame） 的地址格式，并遵循 表 7-2 规定的组合方式。 任何不符合 表 7-2 规定的组合方式不应生成。 Destination Address Source Address Destination PAN ID Source PAN ID PAN ID Compression Not Present Not Present Not Present Not Present 0 Not Present Not Present Present Not Present 1 Present Not Present Present Not Present 0 Present Not Present Not Present Not Present 1 Not Present Present Not Present Present 0 Not Present Present Not Present Not Present 1 Extended Extended Present Not Present 0 Extended Extended Not Present Not Present 1 Shorta Shorta Present Present 0 Shorta Extended Present Present 0 Extended Shorta Present Present 0 Shorta Extended Present Not Present 1 Extended Shorta Present Not Present 1 Shorta Shorta Present Not Present 1 总结 PAN ID Compression 值 含义 1 目标 PAN ID 与源 PAN ID 相同，省略 Source PAN ID 0 目标 PAN ID 与源 PAN ID 不同，需包含 Destination PAN ID 和 Source PAN ID 该字段的使用可以有效减少 MAC 帧长度，优化网络通信效率。📡 ---","tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"}]},{"title":"802.15.4-sec_related","date":"2025-03-08T02:54:19.000Z","path":"wiki/802-15-4-sec-related/","text":"以 drawio 流程图的形式介绍了 802.15.4(2015) mac layer 的加解密，主要有：incoming frm dec, outcoming frm enc, secure related PIBs。 注：802.15.4 2015&#x2F;2006&#x2F;2003 版本加解密flow上存在差异ß点击流程图可以全屏展开 outgoing frm - enc incoming frm - sec on - dec incoming frm - sec on - dec sec pib related","tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"}]}],"categories":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/categories/802-15-4/"}],"tags":[{"name":"802.15.4","slug":"802-15-4","permalink":"http://example.com/tags/802-15-4/"}]}